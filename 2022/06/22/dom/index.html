<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.14.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="二、dom介绍2.1 dom 简介DOM –&gt; Document Object Model 文档对象模型 文档表示的就是整个的 HTML 网页文档 对象表示将网页中的每一个部分都转换成一个对象 模型表示对象之间的关系，从而方便获取对象 通过 DOM 将所有页面内容表示为可以修改的对象。 window 是根对象，首先，它是 JavaScript 代码的全局对象。其次，它代表“浏览器窗口”，并提">
<meta property="og:type" content="article">
<meta property="og:title" content="DOM">
<meta property="og:url" content="http://example.com/2022/06/22/dom/index.html">
<meta property="og:site_name" content="小吴的Blog">
<meta property="og:description" content="二、dom介绍2.1 dom 简介DOM –&gt; Document Object Model 文档对象模型 文档表示的就是整个的 HTML 网页文档 对象表示将网页中的每一个部分都转换成一个对象 模型表示对象之间的关系，从而方便获取对象 通过 DOM 将所有页面内容表示为可以修改的对象。 window 是根对象，首先，它是 JavaScript 代码的全局对象。其次，它代表“浏览器窗口”，并提">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-06-22T05:34:11.000Z">
<meta property="article:modified_time" content="2023-03-20T08:32:34.099Z">
<meta property="article:author" content="Wh&amp;CC">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2022/06/22/dom/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2022/06/22/dom/","path":"2022/06/22/dom/","title":"DOM"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>DOM | 小吴的Blog</title>
  






  <script async defer data-website-id="" src=""></script>

  <script defer data-domain="" src=""></script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="小吴的Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">小吴的Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81dom%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">二、dom介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-dom-%E7%AE%80%E4%BB%8B"><span class="nav-number">1.1.</span> <span class="nav-text">2.1 dom 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-bom-%E7%AE%80%E4%BB%8B"><span class="nav-number">1.2.</span> <span class="nav-text">2.2 bom 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E8%A7%84%E8%8C%83"><span class="nav-number">1.3.</span> <span class="nav-text">2.3 规范</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7"><span class="nav-number">1.4.</span> <span class="nav-text">2.4 浏览器开发工具</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81dom%E5%AD%A6%E4%B9%A0"><span class="nav-number">2.</span> <span class="nav-text">三、dom学习</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-dom%E7%9A%84%E9%81%8D%E5%8E%86"><span class="nav-number">2.1.</span> <span class="nav-text">3.1 dom的遍历</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-1-%E9%A1%B6%E9%83%A8%E8%8A%82%E7%82%B9"><span class="nav-number">2.1.1.</span> <span class="nav-text">3.1.1 顶部节点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-2-%E5%AD%90%E8%8A%82%E7%82%B9"><span class="nav-number">2.1.2.</span> <span class="nav-text">3.1.2 子节点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-3-%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9%E5%92%8C%E7%88%B6%E8%8A%82%E7%82%B9"><span class="nav-number">2.1.3.</span> <span class="nav-text">3.1.3 兄弟节点和父节点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-4-%E7%BA%AF%E5%85%83%E7%B4%A0%E5%AF%BC%E8%88%AA"><span class="nav-number">2.1.4.</span> <span class="nav-text">3.1.4 纯元素导航</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-5-%E8%A1%A8%E6%A0%BC"><span class="nav-number">2.1.5.</span> <span class="nav-text">3.1.5 表格</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E6%90%9C%E7%B4%A2"><span class="nav-number">2.2.</span> <span class="nav-text">3.2 搜索</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-1-getElementsBy"><span class="nav-number">2.2.1.</span> <span class="nav-text">3.2.1 getElementsBy*</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-2-elem-querySelector"><span class="nav-number">2.2.2.</span> <span class="nav-text">3.2.2 elem.querySelector*</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-3-matches"><span class="nav-number">2.2.3.</span> <span class="nav-text">3.2.3 matches</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-4-closest"><span class="nav-number">2.2.4.</span> <span class="nav-text">3.2.4 closest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-5-%E6%80%BB%E7%BB%93"><span class="nav-number">2.2.5.</span> <span class="nav-text">3.2.5 总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7"><span class="nav-number">2.3.</span> <span class="nav-text">3.3 节点属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-1-nodetype"><span class="nav-number">2.3.1.</span> <span class="nav-text">3.3.1 nodetype</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-2-%E6%A0%87%E7%AD%BE"><span class="nav-number">2.3.2.</span> <span class="nav-text">3.3.2 标签</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-3-%E5%86%85%E5%AE%B9-innerHTML"><span class="nav-number">2.3.3.</span> <span class="nav-text">3.3.3 内容 innerHTML</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-4-%E5%85%83%E7%B4%A0%E7%9A%84%E5%AE%8C%E6%95%B4HTML"><span class="nav-number">2.3.4.</span> <span class="nav-text">3.3.4 元素的完整HTML</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-5-%E6%96%87%E6%9C%AC%E8%8A%82%E7%82%B9%E5%86%85%E5%AE%B9"><span class="nav-number">2.3.5.</span> <span class="nav-text">3.3.5 文本节点内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-6-%E6%9B%B4%E5%A4%9A%E5%B1%9E%E6%80%A7"><span class="nav-number">2.3.6.</span> <span class="nav-text">3.3.6 更多属性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-%E7%89%B9%E6%80%A7%E5%92%8C%E5%B1%9E%E6%80%A7-attributes-amp-properties"><span class="nav-number">2.4.</span> <span class="nav-text">3.4 特性和属性(attributes &amp; properties)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-1-DOM%E5%B1%9E%E6%80%A7"><span class="nav-number">2.4.1.</span> <span class="nav-text">3.4.1 DOM属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-2-HTML%E7%89%B9%E6%80%A7"><span class="nav-number">2.4.2.</span> <span class="nav-text">3.4.2 HTML特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-3-%E5%B1%9E%E6%80%A7%E3%80%81%E7%89%B9%E6%80%A7%E5%90%8C%E6%AD%A5"><span class="nav-number">2.4.3.</span> <span class="nav-text">3.4.3 属性、特性同步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-4-%E9%9D%9E%E6%A0%87%E5%87%86%E5%B1%9E%E6%80%A7%EF%BC%8Cdataset"><span class="nav-number">2.4.4.</span> <span class="nav-text">3.4.4 非标准属性，dataset</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-%E4%BF%AE%E6%94%B9%E6%96%87%E6%A1%A3%EF%BC%88document%EF%BC%89"><span class="nav-number">2.4.5.</span> <span class="nav-text">3.5 修改文档（document）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-1-%E4%BB%A5html%E5%BD%A2%E5%BC%8F%E6%8F%92%E5%85%A5"><span class="nav-number">2.4.6.</span> <span class="nav-text">3.5.1 以html形式插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-2-%E8%8A%82%E7%82%B9%E7%A7%BB%E9%99%A4"><span class="nav-number">2.4.7.</span> <span class="nav-text">3.5.2 节点移除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-3-%E5%85%8B%E9%9A%86%E8%8A%82%E7%82%B9-cloneNode"><span class="nav-number">2.4.8.</span> <span class="nav-text">3.5.3 克隆节点(cloneNode)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-4-%E4%B8%80%E4%BA%9B%E5%8F%A4%E8%80%81%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">2.4.9.</span> <span class="nav-text">3.5.4 一些古老的方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-%E6%A0%B7%E5%BC%8F%E5%92%8C%E7%B1%BB"><span class="nav-number">2.5.</span> <span class="nav-text">3.6 样式和类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-1-%E5%85%83%E7%B4%A0%E6%A0%B7%E5%BC%8F"><span class="nav-number">2.5.1.</span> <span class="nav-text">3.6.1 元素样式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-2-%E9%87%8D%E7%BD%AE%E6%A0%B7%E5%BC%8F%E5%B1%9E%E6%80%A7"><span class="nav-number">2.5.2.</span> <span class="nav-text">3.6.2 重置样式属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-3-%E8%AE%A1%E7%AE%97%E6%A0%B7%E5%BC%8FgetComputedStyle"><span class="nav-number">2.5.3.</span> <span class="nav-text">3.6.3 计算样式getComputedStyle</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7-%E5%85%83%E7%B4%A0%E5%A4%A7%E5%B0%8F%E5%92%8C%E6%BB%9A%E5%8A%A8"><span class="nav-number">2.6.</span> <span class="nav-text">3.7 元素大小和滚动</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-1-%E5%85%B3%E4%BA%8E%E7%A5%96%E5%85%88%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-number">2.6.1.</span> <span class="nav-text">3.7.1 关于祖先的属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-2-%E5%85%B3%E4%BA%8E%E5%85%83%E7%B4%A0%E6%9C%AC%E8%BA%AB%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-number">2.6.2.</span> <span class="nav-text">3.7.2 关于元素本身的属性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-7-2-1-%E5%85%83%E7%B4%A0%E5%A4%96%E9%83%A8%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-number">2.6.2.1.</span> <span class="nav-text">3.7.2.1 元素外部的属性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-7-2-2-%E5%85%83%E7%B4%A0%E6%9C%AC%E8%BA%AB%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-number">2.6.2.2.</span> <span class="nav-text">3.7.2.2 元素本身的属性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-3-%E6%BB%9A%E5%8A%A8"><span class="nav-number">2.6.3.</span> <span class="nav-text">3.7.3 滚动</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-8-%E5%9D%90%E6%A0%87"><span class="nav-number">2.7.</span> <span class="nav-text">3.8 坐标</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-8-1-%E5%85%83%E7%B4%A0%E5%9D%90%E6%A0%87"><span class="nav-number">2.7.1.</span> <span class="nav-text">3.8.1 元素坐标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-8-2-%E7%94%A8%E4%BA%8E%E2%80%9Cfixed%E2%80%9D%E5%AE%9A%E4%BD%8D"><span class="nav-number">2.7.2.</span> <span class="nav-text">3.8.2 用于“fixed”定位</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BA%8B%E4%BB%B6%E7%AE%80%E4%BB%8B"><span class="nav-number">3.</span> <span class="nav-text">4 浏览器事件简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="nav-number">3.1.</span> <span class="nav-text">4.1 事件处理程序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-1-HTML%E7%89%B9%E6%80%A7"><span class="nav-number">3.1.1.</span> <span class="nav-text">4.1.1 HTML特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-2-DOM%E5%B1%9E%E6%80%A7"><span class="nav-number">3.1.2.</span> <span class="nav-text">4.1.2 DOM属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-3-this%E5%85%83%E7%B4%A0"><span class="nav-number">3.1.3.</span> <span class="nav-text">4.1.3 this元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-4-%E4%B8%80%E4%BA%9B%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E7%82%B9"><span class="nav-number">3.1.4.</span> <span class="nav-text">4.1.4 一些需要注意的点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-5-addEventListener"><span class="nav-number">3.1.5.</span> <span class="nav-text">4.1.5 addEventListener</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-6-%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.1.6.</span> <span class="nav-text">4.1.6 事件对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-7-%E5%AF%B9%E8%B1%A1%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F"><span class="nav-number">3.1.7.</span> <span class="nav-text">4.1.7 对象处理程序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E5%86%92%E6%B3%A1%E5%92%8C%E6%8D%95%E8%8E%B7"><span class="nav-number">3.2.</span> <span class="nav-text">4.2 冒泡和捕获</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1-%E5%86%92%E6%B3%A1-bubbing"><span class="nav-number">3.2.1.</span> <span class="nav-text">4.2.1 冒泡(bubbing)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-2-event-target"><span class="nav-number">3.2.2.</span> <span class="nav-text">4.2.2 event.target</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-3-%E5%81%9C%E6%AD%A2%E5%86%92%E6%B3%A1"><span class="nav-number">3.2.3.</span> <span class="nav-text">4.2.3 停止冒泡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-4-%E6%8D%95%E8%8E%B7"><span class="nav-number">3.2.4.</span> <span class="nav-text">4.2.4 捕获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98"><span class="nav-number">3.3.</span> <span class="nav-text">4.3 事件委托</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-1-%E6%A0%87%E8%AE%B0%E4%B8%AD%E7%9A%84%E8%A1%8C%E4%B8%BA-action-in-markup"><span class="nav-number">3.3.1.</span> <span class="nav-text">4.3.1 标记中的行为(action in markup)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-2-%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F"><span class="nav-number">3.3.2.</span> <span class="nav-text">4.3.2 行为模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-3-%E6%80%BB%E7%BB%93"><span class="nav-number">3.3.3.</span> <span class="nav-text">4.3.3 总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-%E6%B5%8F%E8%A7%88%E5%99%A8%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA"><span class="nav-number">3.4.</span> <span class="nav-text">4.4 浏览器默认行为</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-1-%E9%98%BB%E6%AD%A2%E6%B5%8F%E8%A7%88%E5%99%A8%E8%A1%8C%E4%B8%BA"><span class="nav-number">3.4.1.</span> <span class="nav-text">4.4.1 阻止浏览器行为</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-2-%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F%E9%80%89%E9%A1%B9%E2%80%9Cpassive%E2%80%9D"><span class="nav-number">3.4.2.</span> <span class="nav-text">4.4.2 处理程序选项“passive”</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-3-event-defaultPrevented"><span class="nav-number">3.4.3.</span> <span class="nav-text">4.4.3 event.defaultPrevented</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6"><span class="nav-number">3.5.</span> <span class="nav-text">4.5 创建自定义事件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-1-%E4%BA%8B%E4%BB%B6%E6%9E%84%E9%80%A0%E5%99%A8"><span class="nav-number">3.5.1.</span> <span class="nav-text">4.5.1 事件构造器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-2-dispatchEvent"><span class="nav-number">3.5.2.</span> <span class="nav-text">4.5.2 dispatchEvent</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-3-UI%E4%BA%8B%E4%BB%B6"><span class="nav-number">3.5.3.</span> <span class="nav-text">4.5.3 UI事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-4-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6"><span class="nav-number">3.5.4.</span> <span class="nav-text">4.5.4 自定义事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-5-event-preventDefault"><span class="nav-number">3.5.5.</span> <span class="nav-text">4.5.5 event.preventDefault()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-6-%E5%90%8C%E6%AD%A5%E4%BA%8B%E4%BB%B6"><span class="nav-number">3.5.6.</span> <span class="nav-text">4.5.6 同步事件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-6-%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6"><span class="nav-number">3.6.</span> <span class="nav-text">4.6 鼠标事件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-1-%E9%BC%A0%E6%A0%87%E6%8C%89%E9%92%AE"><span class="nav-number">3.6.1.</span> <span class="nav-text">4.6.1 鼠标按钮</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-2-%E7%BB%84%E5%90%88%E9%94%AE"><span class="nav-number">3.6.2.</span> <span class="nav-text">4.6.2 组合键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-3-%E5%9D%90%E6%A0%87"><span class="nav-number">3.6.3.</span> <span class="nav-text">4.6.3 坐标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-4-%E9%98%B2%E6%AD%A2%E5%A4%8D%E5%88%B6"><span class="nav-number">3.6.4.</span> <span class="nav-text">4.6.4 防止复制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-5-%E7%A7%BB%E5%8A%A8%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6"><span class="nav-number">3.6.5.</span> <span class="nav-text">4.6.5 移动鼠标事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-6-6-%E9%BC%A0%E6%A0%87%E6%8B%96%E6%94%BE%E4%BA%8B%E4%BB%B6"><span class="nav-number">3.6.6.</span> <span class="nav-text">4.6.6 鼠标拖放事件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-7-%E6%8C%87%E9%92%88%E4%BA%8B%E4%BB%B6"><span class="nav-number">3.7.</span> <span class="nav-text">4.7 指针事件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-1-%E6%8C%87%E9%92%88%E4%BA%8B%E4%BB%B6%E5%B1%9E%E6%80%A7"><span class="nav-number">3.7.1.</span> <span class="nav-text">4.7.1 指针事件属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-2-%E5%A4%9A%E7%82%B9%E8%A7%A6%E6%8E%A7"><span class="nav-number">3.7.2.</span> <span class="nav-text">4.7.2 多点触控</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-3-pointercancel"><span class="nav-number">3.7.3.</span> <span class="nav-text">4.7.3 pointercancel</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-4-%E6%8C%87%E9%92%88%E6%8D%95%E8%8E%B7"><span class="nav-number">3.7.4.</span> <span class="nav-text">4.7.4 指针捕获</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-8-%E9%94%AE%E7%9B%98%E4%BA%8B%E4%BB%B6"><span class="nav-number">3.8.</span> <span class="nav-text">4.8 键盘事件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-8-1-event-code-%E5%92%8C-event-key"><span class="nav-number">3.8.1.</span> <span class="nav-text">4.8.1 event.code 和 event.key</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-9-%E6%BB%9A%E5%8A%A8%E4%BA%8B%E4%BB%B6"><span class="nav-number">3.9.</span> <span class="nav-text">4.9 滚动事件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E8%A1%A8%E5%8D%95%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95"><span class="nav-number">4.</span> <span class="nav-text">五、表单属性和方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-%E8%81%9A%E7%84%A6%EF%BC%88focus-x2F-blur%EF%BC%89"><span class="nav-number">4.1.</span> <span class="nav-text">5.1 聚焦（focus&#x2F;blur）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-1-tabindex-%E5%BC%BA%E8%A1%8C%E8%81%9A%E7%84%A6"><span class="nav-number">4.1.1.</span> <span class="nav-text">5.1.1 tabindex(强行聚焦)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-2-%E5%A7%94%E6%89%98"><span class="nav-number">4.1.2.</span> <span class="nav-text">5.1.2 委托</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-%E4%BA%8B%E4%BB%B6%EF%BC%9Achange%E3%80%81input%E3%80%81cut%E3%80%81copy%E3%80%81paste"><span class="nav-number">4.2.</span> <span class="nav-text">5.2 事件：change、input、cut、copy、paste</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-1-change"><span class="nav-number">4.2.1.</span> <span class="nav-text">5.2.1 change</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-2-input"><span class="nav-number">4.2.2.</span> <span class="nav-text">5.2.2 input</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-3-cut%E3%80%81copy%E3%80%81paste"><span class="nav-number">4.2.3.</span> <span class="nav-text">5.2.3 cut、copy、paste</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-4-%E5%AE%89%E5%85%A8%E9%99%90%E5%88%B6"><span class="nav-number">4.2.4.</span> <span class="nav-text">5.2.4 安全限制</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-%E8%A1%A8%E5%8D%95%EF%BC%9A%E4%BA%8B%E4%BB%B6%E5%92%8C%E6%96%B9%E6%B3%95%E6%8F%90%E4%BA%A4"><span class="nav-number">4.3.</span> <span class="nav-text">5.3 表单：事件和方法提交</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-1-submit"><span class="nav-number">4.3.1.</span> <span class="nav-text">5.3.1 submit</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-2-%E6%89%8B%E5%8A%A8%E6%8F%90%E4%BA%A4"><span class="nav-number">4.3.2.</span> <span class="nav-text">5.3.2 手动提交</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wh&CC"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Wh&CC</p>
  <div class="site-description" itemprop="description">Per aspera ad astra</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">50</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/sacrifice-w" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;sacrifice-w" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:761612239@qq.com" title="E-Mail → mailto:761612239@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/06/22/dom/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wh&CC">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小吴的Blog">
      <meta itemprop="description" content="Per aspera ad astra">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="DOM | 小吴的Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          DOM
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-06-22 13:34:11" itemprop="dateCreated datePublished" datetime="2022-06-22T13:34:11+08:00">2022-06-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-20 16:32:34" itemprop="dateModified" datetime="2023-03-20T16:32:34+08:00">2023-03-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/" itemprop="url" rel="index"><span itemprop="name">前端知识</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="二、dom介绍"><a href="#二、dom介绍" class="headerlink" title="二、dom介绍"></a>二、dom介绍</h1><h2 id="2-1-dom-简介"><a href="#2-1-dom-简介" class="headerlink" title="2.1 dom 简介"></a>2.1 dom 简介</h2><p>DOM –&gt; Document Object Model 文档对象模型 文档表示的就是整个的 HTML 网页文档 对象表示将网页中的每一个部分都转换成一个对象 模型表示对象之间的关系，从而方便获取对象 <strong>通过 DOM 将所有页面内容表示为可以修改的对象。</strong></p>
<p>window 是<strong>根对象</strong>，首先，它是 JavaScript 代码的全局对象。其次，它代表“浏览器窗口”，并提供了控制它的方法。</p>
<span id="more"></span>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将背景颜色修改为红色</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">background</span> = <span class="string">&quot;red&quot;</span>;</span><br><span class="line"><span class="comment">// 在 1 秒后将其修改回来</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> (<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">background</span> = <span class="string">&quot;&quot;</span>), <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>节点(elem)是构成网页的最基本的组成部分，网页中的每一个部分都是一个节点 一共有12种节点类型，但是通常使用的只有4种;</p>
<ol>
<li><p><code>document</code>是页面的主要“入口点”。我们可以使用它来更改或创建页面上的任何内容。</p>
</li>
<li><p><strong>元素节点</strong>:HTML 文档中的标签,<code>&lt;html&gt;</code>是根节点，<code>&lt;head&gt;</code>,<code>&lt;body&gt;</code>是其子项</p>
</li>
<li><p><strong>文本节点</strong>:元素内的文本形成文本节点，一个文本节点只包含一个字符串。它没有子项，并且总是树的叶子。 <strong>空格和换行符都是完全有效的字符，就像字母和数字。它们形成文本节点并成为 DOM 的一部分。</strong> 由于历史原因,<code>&lt;head&gt;</code>之前的空格和换行符均被忽略。 如果我们在<code>&lt;/body&gt;</code>之后放置一些东西，那么它会被自动移动到<code>body</code>内，并处于<code>body</code>中的最下方，因为HTML规范要求所有内容必须位于<code>&lt;body&gt;</code>内。 <strong>所以<code>&lt;/body&gt;</code>之后不能有空格。</strong> <strong>字符串开头&#x2F;结尾处的空格，以及只有空格的文本节点，通常会被工具隐藏</strong> 与DOM一起使用的浏览器工具通常不会在文本的开始&#x2F;结尾显示空格，并且在标签之间也不会显示空文本节点（换行符）。</p>
</li>
<li><p><strong>注释</strong></p>
</li>
</ol>
<hr>
<p><strong>HTML中的所有内容，甚至注释，都会成为DOM的一部分。</strong> 注释会被标记为 comment node</p>
<hr>
<p>事件：就是用户和浏览器之间的交互行为 比如点击按钮，鼠标移动，关闭窗口等</p>
<p>可以在事件对应的属性中设置 js 代码，当事件被触发时，代码会被执行 所以可以通过对对应事件来绑定处理函数从而响应事件，当事件被触发时，函数会被调用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取按钮对象</span></span><br><span class="line"><span class="keyword">let</span> btn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;btn&quot;</span>);</span><br><span class="line"><span class="comment">// 绑定一个单击事件</span></span><br><span class="line">btn.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>因为页面的加载是自上而下的，所以 script 标签如果想要运行，必须放到 body 里的标签的下面。 所以想要将 script 标签继续放在 head 里，则需要添加一个 onload 事件，从而使响应函数在页面加载完成之后再执行 这样可以保证代码执行时所有的 DOM 对象都已经加载完成了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  xxxx;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-bom-简介"><a href="#2-2-bom-简介" class="headerlink" title="2.2 bom 简介"></a>2.2 bom 简介</h2><p>浏览器对象模型（Browser Object Model），简称 BOM，表示由浏览器（主机环境）提供的用于处理文档（document）之外的所有内容的其他对象。</p>
<p>例如：</p>
<ul>
<li><code>navigator</code>对象提供了有关浏览器和操作系统的背景信息。navigator 有许多属性，但是最广为人知的两个属性是：<code>navigator.userAgent</code>—关于当前浏览器，<code>navigator.platform</code>—关于平台（可以帮助区分 Windows&#x2F;Linux&#x2F;Mac 等）。</li>
<li><code>location</code>对象允许我们读取当前<code>URL</code>，并且可以将浏览器重定向到新的<code>URL</code>。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(location.<span class="property">href</span>); <span class="comment">// 显示当前 URL</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_">confirm</span>(<span class="string">&quot;Go to Wikipedia?&quot;</span>)) &#123;</span><br><span class="line">  location.<span class="property">href</span> = <span class="string">&quot;https://wikipedia.org&quot;</span>; <span class="comment">// 将浏览器重定向到另一个 URL</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数<code>alert/confirm/prompt</code>也是<strong>BOM</strong>的一部分：它们与文档（document）没有直接关系，但它代表了与用户通信的纯浏览器方法。</p>
<h2 id="2-3-规范"><a href="#2-3-规范" class="headerlink" title="2.3 规范"></a>2.3 规范</h2><p><strong>DOM 规范</strong> 描述文档的结构、操作和事件，详见 <a target="_blank" rel="noopener" href="https://dom.spec.whatwg.org/">DOM规范</a>。 CSSOM 规范 描述样式表和样式规则，对它们进行的操作，以及它们与文档的绑定，<a target="_blank" rel="noopener" href="https://www.w3.org/TR/cssom-1/">CSSOM规范</a>。 <strong>HTML 规范</strong> 描述 HTML 语言（例如标签）以及 BOM（浏览器对象模型）— 各种浏览器函数：setTimeout,alert,location等，详见<a target="_blank" rel="noopener" href="https://html.spec.whatwg.org/">HTML规范</a>。它采用了 DOM 规范，并使用了许多其他属性和方法对其进行了扩展。 此外，某些类被分别描述在 <a target="_blank" rel="noopener" href="https://spec.whatwg.org/"></a>。</p>
<h2 id="2-4-浏览器开发工具"><a href="#2-4-浏览器开发工具" class="headerlink" title="2.4 浏览器开发工具"></a>2.4 浏览器开发工具</h2><p>开发者工具中的 DOM 结构是经过简化的。文本节点仅以文本形式显示。并且根本没有“空白”（只有空格）的文本节点。这其实挺好，因为大多数情况下，我们只关心元素节点。 点击左上角的按钮可以让我们使用鼠标（或其他指针设备）从网页中选择一个节点并“检查（inspect）”它（在元素选项卡中滚动到该节点）。当我们有一个巨大的HTML页面（和相应的巨大 DOM），并希望查看其中的一个特定元素的位置时，这很有用。 另一种方法是在网页上右键单击，然后在上下文菜单中选择“检查（Inspect）”。</p>
<ul>
<li><strong>Styles</strong> — 我们可以看到按规则应用于当前元素的CSS规则，包括内建规则（灰色）。几乎所有内容都可以就地编辑，包括下面的方框的dimension&#x2F;margin&#x2F;padding。</li>
<li><strong>Computed</strong> — 按属性查看应用于元素的 CSS：对于每个属性，我们可以都可以看到赋予它的规则（包括CSS继承等）。</li>
<li><strong>Event Listeners</strong> — 查看附加到 DOM 元素的事件侦听器。</li>
</ul>
<p>当然，在浏览器开发工具中，还能够通过与控制台交互来给页面中的元素添加一些js代码和命令。 <code>console.log(elem)</code> 显示元素的 DOM 树。 <code>console.dir(elem)</code> 将元素显示为 DOM 对象，非常适合探索其属性。</p>
<h1 id="三、dom学习"><a href="#三、dom学习" class="headerlink" title="三、dom学习"></a>三、dom学习</h1><h2 id="3-1-dom的遍历"><a href="#3-1-dom的遍历" class="headerlink" title="3.1 dom的遍历"></a>3.1 dom的遍历</h2><h3 id="3-1-1-顶部节点"><a href="#3-1-1-顶部节点" class="headerlink" title="3.1.1 顶部节点"></a>3.1.1 顶部节点</h3><p>最顶层的树节点可以直接作为 document 的属性来使用： <code>&lt;html&gt; = document.documentElement</code> 最顶层的document节点是<code>document.documentElement</code>。这是对应<code>&lt;html&gt;</code>标签的DOM节点。 <code>&lt;body&gt; = document.body</code> -<code>&lt;body&gt;</code>元素 <code>&lt;head&gt; = document.head</code> -<code>&lt;head&gt;</code>元素 脚本无法访问在运行时不存在的元素。 尤其是，如果一个脚本是在<code>&lt;head&gt;</code>中，那么脚本是访问不到<code>document.body</code>元素的，因为浏览器还没有读到它。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">alert</span>( <span class="string">&quot;From HEAD: &quot;</span> + <span class="variable language_">document</span>.<span class="property">body</span> ); <span class="comment">// null，这里目前还没有 &lt;body&gt;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">alert</span>( <span class="string">&quot;From BODY: &quot;</span> + <span class="variable language_">document</span>.<span class="property">body</span> ); <span class="comment">// HTMLBodyElement，现在存在了</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<hr>
<p>在 DOM 中，null 值就意味着“不存在”或者“没有这个节点”。</p>
<hr>
<h3 id="3-1-2-子节点"><a href="#3-1-2-子节点" class="headerlink" title="3.1.2 子节点"></a>3.1.2 子节点</h3><p>子节点 — 对应的是直系的子元素。换句话说，它们被完全嵌套在给定的元素中。例如，<code>&lt;head&gt;</code>和<code>&lt;body&gt;</code>就是<code>&lt;html&gt;</code>元素的子元素。 子孙元素 — 嵌套在给定元素中的所有元素，包括子元素，以及子元素的子元素等。</p>
<p><code>childNodes</code>属性会获取包括文本节点在内的所有节点，包括<strong>文字节点</strong> <code>firstChild</code>获取当前节点的第一个子节点 <code>lastChild</code>获取当前节点的最后一个子节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">elem.<span class="property">childNodes</span>[<span class="number">0</span>] === elem.<span class="property">firstChild</span></span><br><span class="line">elem.<span class="property">childNodes</span>[elem.<span class="property">childNodes</span>.<span class="property">length</span> - <span class="number">1</span>] === elem.<span class="property">lastChild</span></span><br></pre></td></tr></table></figure>

<p>这里还有一个特别的函数<code>elem.hasChildNodes()</code>用于检查节点是否有子节点。</p>
<p><code>childNodes</code>看起来就像一个数组。但实际上它并不是一个数组，而是一个<strong>集合</strong>— 一个类数组的可迭代对象。</p>
<ul>
<li>可以使用for…of来迭代</li>
<li>无法使用数组的方法，因为他不是一个数组 如果我们想要使用数组的方法的话，我们可以使用<code>Array.from</code>方法来从集合创建一个“真”数组：</li>
</ul>
<p><strong>DOM 集合是只读的</strong> <strong>DOM 集合是实时的</strong> <strong>不要使用 for..in 来遍历集合</strong></p>
<h3 id="3-1-3-兄弟节点和父节点"><a href="#3-1-3-兄弟节点和父节点" class="headerlink" title="3.1.3 兄弟节点和父节点"></a>3.1.3 兄弟节点和父节点</h3><p><strong>兄弟节点（Sibling）</strong> 是指有同一个父节点的节点。 下一个兄弟节点在<code>nextSibling</code>属性中，上一个是在<code>previousSibling</code>属性中。 可以通过<code>parentNode</code>来访问父节点。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;body&gt; 的父节点是 &lt;html&gt;</span></span><br><span class="line"><span class="title function_">alert</span>( <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">parentNode</span> === <span class="variable language_">document</span>.<span class="property">documentElement</span> ); <span class="comment">// true</span></span><br><span class="line"><span class="comment">// &lt;head&gt; 的后一个是 &lt;body&gt;</span></span><br><span class="line"><span class="title function_">alert</span>( <span class="variable language_">document</span>.<span class="property">head</span>.<span class="property">nextSibling</span> ); <span class="comment">// HTMLBodyElement</span></span><br><span class="line"><span class="comment">// &lt;body&gt; 的前一个是 &lt;head&gt;</span></span><br><span class="line"><span class="title function_">alert</span>( <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">previousSibling</span> ); <span class="comment">// HTMLHeadElement</span></span><br></pre></td></tr></table></figure>

<h3 id="3-1-4-纯元素导航"><a href="#3-1-4-纯元素导航" class="headerlink" title="3.1.4 纯元素导航"></a>3.1.4 纯元素导航</h3><p>上面列出的导航（navigation）属性引用<strong>所有</strong>节点。例如，在<strong>childNodes</strong>中我们可以看到文本节点，元素节点，甚至包括注释节点（如果它们存在的话）。 但是对于很多任务来说，我们并不想要文本节点或注释节点。我们希望操纵的是代表标签的和形成页面结构的元素节点。 所以，让我们看看更多只考虑<strong>元素节点</strong>的导航链接（navigation link） 这些链接和我们在上面提到过的类似，只是在词中间加了 Element：</p>
<ul>
<li><code>children</code> — 仅那些作为元素节点的子代的节点。</li>
<li><code>firstElementChild</code>，<code>lastElementChild</code> — 第一个和最后一个子元素。</li>
<li><code>previousElementSibling</code>，<code>nextElementSibling</code> — 兄弟元素。</li>
<li><code>parentElement</code> — 父元素。</li>
</ul>
<p>parentElement 属性返回的是“元素类型”的父节点，而 parentNode 返回的是“任何类型”的父节点。这些属性通常来说是一样的：它们都是用于获取父节点。 唯一的例外就是 <strong>document.documentElement</strong>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>( <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">parentNode</span> ); <span class="comment">// document</span></span><br><span class="line"><span class="title function_">alert</span>( <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">parentElement</span> ); <span class="comment">// null</span></span><br></pre></td></tr></table></figure>

<h3 id="3-1-5-表格"><a href="#3-1-5-表格" class="headerlink" title="3.1.5 表格"></a>3.1.5 表格</h3><p>表格（Table）是一个很好的例子，它代表了一个特别重要的情况：</p>
<p><code>&lt;table&gt;</code>元素支持(除了上面给出的，之外) 以下这些属性: <code>table.rows</code> — <code>&lt;tr&gt;</code> 元素的集合。 <code>table.caption/tHead/tFoot</code> — 引用元素 <code>&lt;caption&gt;，&lt;thead&gt;，&lt;tfoot&gt;</code>。 <code>table.tBodies</code> — <code>&lt;tbody&gt;</code>元素的集合（根据标准还有很多元素，但是这里至少会有一个 — 即使没有被写在HTML源文件中，浏览器也会将其放入DOM中）。 <code>&lt;thead&gt;，&lt;tfoot&gt;，&lt;tbody&gt;</code> 元素提供了 rows 属性： <code>tbody.rows</code> — 表格内部<code>&lt;tr&gt;</code>元素的集合。 <code>&lt;tr&gt;</code>： <code>tr.cells</code> — 在给定 <code>&lt;tr&gt;</code> 中的 <code>&lt;td&gt;</code> 和 <code>&lt;th&gt;</code> 单元格的集合。 <code>tr.sectionRowIndex</code> — 给定的 <code>&lt;tr&gt;</code> 在封闭的 <code>&lt;thead&gt;/&lt;tbody&gt;/&lt;tfoot&gt;</code> 中的位置（索引）。 <code>tr.rowIndex</code> — 在整个表格中 <code>&lt;tr&gt;</code> 的编号（包括表格的所有行）。 <code>&lt;td&gt; 和 &lt;th&gt;</code>： <code>td.cellIndex</code> — 在封闭的 <code>&lt;tr&gt;</code>中单元格的编号。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;table&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>one<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>two<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>three<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>four<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 获取带有 &quot;two&quot; 的 td（第一行，第二列）</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> td = table.<span class="property">rows</span>[<span class="number">0</span>].<span class="property">cells</span>[<span class="number">1</span>];</span></span><br><span class="line"><span class="language-javascript">  td.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&quot;red&quot;</span>; <span class="comment">// highlight it</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-2-搜索"><a href="#3-2-搜索" class="headerlink" title="3.2 搜索"></a>3.2 搜索</h2><h3 id="3-2-1-getElementsBy"><a href="#3-2-1-getElementsBy" class="headerlink" title="3.2.1 getElementsBy*"></a>3.2.1 getElementsBy*</h3><p>通过<strong>document</strong>对象调用获取元素节点 <strong>只有<code>document.getElementById</code>，没有<code>anyElem.getElementById</code></strong> getElementById() 通过 id 属性获取一个元素节点对象 getElementById方法只能被在document对象上调用。它会在整个文档中查找给定的id。</p>
<ol>
<li>document.getElementsByTagName() 通过标签名获取一组元素节点对象 这个会返回一个类数组对象，会将所有返回的内容封装到一个对象中，即使其只有一个</li>
<li>document.getElementsByName() 通过 name 属性获取一组元素节点对象</li>
</ol>
<p><code>elem.getElementsByClassName(className)</code>返回具有给定CSS类的元素。</p>
<p>所有的 “getElementsBy*“ 方法都会返回一个 <strong>实时的（live）</strong> 集合。这样的集合始终反映的是文档的当前状态，并且在文档发生更改时会“自动更新”。 相反，querySelectorAll 返回的是一个 <strong>静态的</strong> 集合。就像元素的固定数组。</p>
<h3 id="3-2-2-elem-querySelector"><a href="#3-2-2-elem-querySelector" class="headerlink" title="3.2.2 elem.querySelector*"></a>3.2.2 elem.querySelector*</h3><p>最常用的方法： <code>elem.querySelectorAll(css)</code>返回<strong>elem</strong>中与给定<strong>CSS</strong>选择器匹配的所有元素。 在这里，我们查找所有为最后一个子元素的<code>&lt;li&gt;</code>元素：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>The<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>test<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>has<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>passed<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> elements = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;ul &gt; li:last-child&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span> (<span class="keyword">let</span> elem <span class="keyword">of</span> elements) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(elem.<span class="property">innerHTML</span>); <span class="comment">// &quot;test&quot;, &quot;passed&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>CSS选择器的伪类，例如 :hover 和 :active 也都是被支持的。例如，<code>document.querySelectorAll(&#39;:hover&#39;)</code> 将会返回鼠标指针正处于其上方的元素的集合（按嵌套顺序：从最外层 <code>&lt;html&gt;</code> 到嵌套最多的元素）。</p>
<p><code>elem.querySelector(css)</code>调用会返回给定CSS选择器的<strong>第一个</strong>元素。 换句话说，结果与<code>elem.querySelectorAll(css)[0]</code>相同，但是后者会查找<strong>所有</strong>元素，并从中选取一个，而<code>elem.querySelector</code>只会查找一个。因此它在速度上更快，并且写起来更短。</p>
<h3 id="3-2-3-matches"><a href="#3-2-3-matches" class="headerlink" title="3.2.3 matches"></a>3.2.3 matches</h3><p><code>elem.matches(css)</code>不会查找任何内容，它只会检查 elem 是否与给定的 CSS 选择器匹配。它返回 true 或 false。</p>
<p>当我们遍历元素（例如数组或其他内容）并试图过滤那些我们感兴趣的元素时，这个方法会很有用。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://example.com/file.zip&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://ya.ru&quot;</span>&gt;</span>...<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 不一定是 document.body.children，还可以是任何集合</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span> (<span class="keyword">let</span> elem <span class="keyword">of</span> <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">children</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// $=是以xxx结尾的意思，这里的意思是以zip结尾</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (elem.<span class="title function_">matches</span>(<span class="string">&#x27;a[href$=&quot;zip&quot;]&#x27;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="string">&quot;The archive reference: &quot;</span> + elem.<span class="property">href</span> );</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-4-closest"><a href="#3-2-4-closest" class="headerlink" title="3.2.4 closest"></a>3.2.4 closest</h3><p>元素的祖先（ancestor）是：父级，父级的父级，它的父级等。祖先们一起组成了从元素到顶端的父级链。 <code>elem.closest(css)</code>方法会查找与 CSS 选择器匹配的最近的祖先。elem 自己也会被搜索。 换句话说，方法<code>closest</code>在元素中得到了提升，并检查每个父级。如果它与选择器匹配，则停止搜索并返回该祖先。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Contents<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;contents&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;book&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;chapter&quot;</span>&gt;</span>Chapter 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;chapter&quot;</span>&gt;</span>Chapter 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> chapter = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.chapter&#x27;</span>); <span class="comment">// LI</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(chapter.<span class="title function_">closest</span>(<span class="string">&#x27;.book&#x27;</span>)); <span class="comment">// UL</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(chapter.<span class="title function_">closest</span>(<span class="string">&#x27;.contents&#x27;</span>)); <span class="comment">// DIV</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(chapter.<span class="title function_">closest</span>(<span class="string">&#x27;h1&#x27;</span>)); <span class="comment">// null（因为 h1 不是祖先）</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-5-总结"><a href="#3-2-5-总结" class="headerlink" title="3.2.5 总结"></a>3.2.5 总结</h3><p>方法名</p>
<p>搜索方式</p>
<p>可以在元素上调用？</p>
<p>实时的？</p>
<p>querySelector</p>
<p>CSS-selector</p>
<p>✔</p>
<p>-</p>
<p>querySelectorAll</p>
<p>CSS-selector</p>
<p>✔</p>
<p>-</p>
<p>getElementById</p>
<p>id</p>
<p>-</p>
<p>-</p>
<p>getElementsByName</p>
<p>name</p>
<p>-</p>
<p>✔</p>
<p>getElementsByTagName</p>
<p>tag or ‘*‘</p>
<p>✔</p>
<p>✔</p>
<p>getElementsByClassName</p>
<p>class</p>
<p>✔</p>
<p>✔</p>
<p>用来检查子级与父级之间关系的方法： 如果 elemB 在 elemA 内（elemA 的后代）或者 elemA&#x3D;&#x3D;elemB，elemA.contains(elemB) 将返回 true。</p>
<h2 id="3-3-节点属性"><a href="#3-3-节点属性" class="headerlink" title="3.3 节点属性"></a>3.3 节点属性</h2><ul>
<li>EventTarget — 是根的“抽象（abstract）”类。该类的对象从未被创建。它作为一个基础，以便让所有 DOM 节点都支持所谓的“事件（event）”。</li>
<li>Node — 也是一个“抽象”类，充当 DOM 节点的基础。它提供了树的核心功能：parentNode，nextSibling，childNodes 等（它们都是 getter）。Node 类的对象从未被创建。但是有一些继承自它的具体的节点类，例如：文本节点的 Text，元素节点的 Element，以及更多异域（exotic）类，例如注释节点的 Comment。</li>
<li>Element — 是 DOM 元素的基本类。它提供了元素级的导航（navigation），例如 nextElementSibling，children，以及像 getElementsByTagName 和 querySelector 这样的搜索方法。浏览器中不仅有 HTML，还会有 XML 和 SVG。Element 类充当更多特定类的基本类：SVGElement，XMLElement 和 HTMLElement。</li>
<li>HTMLElement — 最终是所有 HTML 元素的基本类。各种 HTML 元素均继承自它：<ul>
<li>HTMLInputElement — <code>&lt;input&gt;</code> 元素的类，</li>
<li>HTMLBodyElement —<code>&lt;body&gt;</code> 元素的类，</li>
<li>HTMLAnchorElement — <code>&lt;a&gt;</code> 元素的类，</li>
</ul>
</li>
</ul>
<p>还有很多其他标签具有自己的类，可能还具有特定的属性和方法，而一些元素，如 <code>&lt;span&gt;、&lt;section&gt;、&lt;article&gt;</code> 等，没有任何特定的属性，所以它们是 HTMLElement 类的实例。</p>
<p><strong>给定节点的全部属性和方法都是继承的结果。</strong></p>
<ul>
<li>HTMLInputElement — 该类提供特定于输入的属性，</li>
<li>HTMLElement — 它提供了通用（common）的 HTML 元素方法（以及 getter 和 setter）</li>
<li>Element — 提供通用（generic）元素方法，</li>
<li>Node — 提供通用 DOM 节点属性，</li>
<li>EventTarget — 为事件（包括事件本身）提供支持，</li>
<li>……最后，它继承自 Object，因为像 hasOwnProperty 这样的“普通对象”方法也是可用的。</li>
</ul>
<p>可以通过回调来查看 DOM 节点类名,<strong>constructor.name</strong> 就是它的名称 <code>alert( document.body.constructor.name ); // HTMLBodyElement</code> 或者可以使用<strong>toString</strong>方法 可以使用 <strong>instanceof</strong> 来检查继承：</p>
<p>在规范中，DOM 类不是使用 JavaScript 来描述的，而是一种特殊的 <strong>接口描述语言</strong>（Interface description language），简写为 <strong>IDL</strong>，它通常很容易理解。 在 IDL 中，所有属性以其类型开头。例如，DOMString 和 boolean 等。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义 HTMLInputElement</span></span><br><span class="line"><span class="comment">// 冒号 &quot;:&quot; 表示 HTMLInputElement 继承自 HTMLElement</span></span><br><span class="line">interface <span class="title class_">HTMLInputElement</span>: <span class="title class_">HTMLElement</span> &#123;</span><br><span class="line">  <span class="comment">// 接下来是 &lt;input&gt; 元素的属性和方法</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// &quot;DOMString&quot; 表示属性的值是字符串</span></span><br><span class="line">  attribute <span class="title class_">DOMString</span> accept;</span><br><span class="line">  attribute <span class="title class_">DOMString</span> alt;</span><br><span class="line">  attribute <span class="title class_">DOMString</span> autocomplete;</span><br><span class="line">  attribute <span class="title class_">DOMString</span> value;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 布尔值属性（true/false）</span></span><br><span class="line">  attribute boolean autofocus;</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">// 现在方法：&quot;void&quot; 表示方法没有返回值</span></span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">select</span>();</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-1-nodetype"><a href="#3-3-1-nodetype" class="headerlink" title="3.3.1 nodetype"></a>3.3.1 nodetype</h3><p>nodeType属性时一种古老的用来获取DOM节点类型的方法 它有一个数值型值（numeric value）： 对于元素节点 elem.nodeType &#x3D;&#x3D; 1， 对于文本节点 elem.nodeType &#x3D;&#x3D; 3， 对于 document 对象 elem.nodeType &#x3D;&#x3D; 9， 在 规范 中还有一些其他值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> elem = <span class="variable language_">document</span>.<span class="property">body</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 让我们检查一下它是什么？</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(elem.<span class="property">nodeType</span>); <span class="comment">// 1 =&gt; element</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 第一个子节点是</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(elem.<span class="property">firstChild</span>.<span class="property">nodeType</span>); <span class="comment">// 3 =&gt; text</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 对于 document 对象，类型是 9</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>( <span class="variable language_">document</span>.<span class="property">nodeType</span> ); <span class="comment">// 9</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在现代脚本中，我们可以使用<strong>instanceof</strong>和其他基于类的检查方法来查看节点类型，但有时 nodeType 可能更简单。我们只能读取 nodeType 而不能修改它。</p>
<h3 id="3-3-2-标签"><a href="#3-3-2-标签" class="headerlink" title="3.3.2 标签"></a>3.3.2 标签</h3><p>给定一个 DOM 节点，我们可以从 <strong>nodeName</strong> 或者 <strong>tagName</strong> 属性中读取它的标签名：</p>
<ul>
<li>tagName 属性仅适用于 Element 节点。</li>
<li>nodeName 是为任意 Node 定义的：<ul>
<li>对于元素，它的意义与 tagName 相同。</li>
<li>对于其他节点类型（text，comment 等），它拥有一个对应节点类型的字符串。</li>
</ul>
</li>
</ul>
<p>tagName仅受<strong>元素节点</strong>支持（因为它起源于Element类），而nodeName则可以说明其他节点类型。</p>
<p><strong>标签名称始终是大写的，除非是在 XML 模式下</strong></p>
<h3 id="3-3-3-内容-innerHTML"><a href="#3-3-3-内容-innerHTML" class="headerlink" title="3.3.3 内容 innerHTML"></a>3.3.3 内容 innerHTML</h3><p>innerHTML 属性允许将元素中的 HTML 获取为字符串形式。 我们也可以修改它。因此，它是更改页面最有效的方法之一。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>A paragraph<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>A div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>( <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> ); <span class="comment">// 读取当前内容</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;The new BODY!&#x27;</span>; <span class="comment">// 替换它</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 输出显示 The new BODY! ，通过innerHTML修改了页面内容--&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果 innerHTML 将一个<code>&lt;script&gt;</code>标签插入到 document 中 — 它会成为 HTML 的一部分，但是不会执行。</p>
<p>可以使用<code>elem.innerHTML+=&quot;more html&quot;</code>将 HTML 附加到元素上。 但是这是一种非常危险的方法，因为它会先将旧的内容删除，再写入新的内容，所以会产生重新加载等问题，使用需要谨慎。</p>
<h3 id="3-3-4-元素的完整HTML"><a href="#3-3-4-元素的完整HTML" class="headerlink" title="3.3.4 元素的完整HTML"></a>3.3.4 元素的完整HTML</h3><p>outerHTML 属性包含了元素的完整 HTML。就像 innerHTML 加上元素本身一样。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span>&gt;</span>Hello <span class="tag">&lt;<span class="name">b</span>&gt;</span>World<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  alert(elem.outerHTML); // <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span>&gt;</span>Hello <span class="tag">&lt;<span class="name">b</span>&gt;</span>World<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>与 innerHTML 不同，写入 outerHTML 不会改变元素。而是在 DOM 中替换它。</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello, world!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 使用 &lt;p&gt;...&lt;/p&gt; 替换 div.outerHTML</span></span></span><br><span class="line"><span class="language-javascript">  div.<span class="property">outerHTML</span> = <span class="string">&#x27;&lt;p&gt;A new element&lt;/p&gt;&#x27;</span>; <span class="comment">// (*)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 蛤！&#x27;div&#x27; 还是原来那样！</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(div.<span class="property">outerHTML</span>); <span class="comment">// &lt;div&gt;Hello, world!&lt;/div&gt; (**)</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>谨慎谨慎再谨慎！！！</strong></p>
<h3 id="3-3-5-文本节点内容"><a href="#3-3-5-文本节点内容" class="headerlink" title="3.3.5 文本节点内容"></a>3.3.5 文本节点内容</h3><p>innerHTML 属性仅对元素节点有效。 其他节点类型，例如文本节点，具有它们的对应项：<strong>nodeValue</strong> 和<strong>data</strong>属性。这两者在实际使用中几乎相同，只有细微规范上的差异。因此，我们将使用 data，因为它更短。 读取文本节点和注释节点的内容的示例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  Hello</span><br><span class="line">  <span class="comment">&lt;!-- Comment --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> text = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">firstChild</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(text.<span class="property">data</span>); <span class="comment">// Hello</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> comment = text.<span class="property">nextSibling</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(comment.<span class="property">data</span>); <span class="comment">// Comment</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>textContent</strong> 提供了对元素内的文本的访问权限：仅文本，去掉所有<code>&lt;tags&gt;</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;news&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Headline!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Martians attack people!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Headline! Martians attack people!</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(news.<span class="property">textContent</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>写入 textContent 要有用得多，因为它允许以“安全方式”写入文本。</strong></p>
<h3 id="3-3-6-更多属性"><a href="#3-3-6-更多属性" class="headerlink" title="3.3.6 更多属性"></a>3.3.6 更多属性</h3><p>“hidden” 特性（attribute）和 DOM 属性（property）指定元素是否可见。 从技术上来说，hidden 与 style&#x3D;”display:none” 做的是相同的事。但 hidden 写法更简洁。 这里有一个 blinking 元素：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span>&gt;</span>A blinking element<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> elem.<span class="property">hidden</span> = !elem.<span class="property">hidden</span>, <span class="number">1000</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>value — <code>&lt;input&gt;，&lt;select&gt; 和 &lt;textarea&gt;</code>（HTMLInputElement，HTMLSelectElement……）的 value。</p>
</li>
<li><p>href — <code>&lt;a href=&quot;...&quot;&gt;</code>（HTMLAnchorElement）的 href。</p>
</li>
<li><p>id — 所有元素（HTMLElement）的 “id” 特性（attribute）的值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span> <span class="attr">value</span>=<span class="string">&quot;value&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">alert</span>(elem.<span class="property">type</span>); <span class="comment">// &quot;text&quot;</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">alert</span>(elem.<span class="property">id</span>); <span class="comment">// &quot;elem&quot;</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">alert</span>(elem.<span class="property">value</span>); <span class="comment">// value</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-4-特性和属性-attributes-amp-properties"><a href="#3-4-特性和属性-attributes-amp-properties" class="headerlink" title="3.4 特性和属性(attributes &amp; properties)"></a>3.4 特性和属性(attributes &amp; properties)</h2><p>当浏览器加载页面时，它会“读取”（或者称之为：“解析”）HTML 并从中生成 DOM 对象。对于元素节点，大多数标准的 HTML 特性（attributes）会自动变成 DOM 对象的属性（properties）。 attribute 和 property 两词意思相近，为作区分，全文将 attribute 译为“特性”，property 译为“属性”。</p>
<h3 id="3-4-1-DOM属性"><a href="#3-4-1-DOM属性" class="headerlink" title="3.4.1 DOM属性"></a>3.4.1 DOM属性</h3><p>DOM 节点是常规的 JavaScript 对象。我们可以 alert 它们。 <strong>可以创建新的属性</strong>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">myData</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;Caesar&#x27;</span>,</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;Imperator&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">myData</span>.<span class="property">title</span>); <span class="comment">// Imperator</span></span><br></pre></td></tr></table></figure>

<p><strong>可以添加新的方法</strong>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">sayTagName</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">tagName</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">sayTagName</span>(); <span class="comment">// BODY（这个方法中的 &quot;this&quot; 的值是 document.body）</span></span><br></pre></td></tr></table></figure>

<p><strong>可以修改内建属性的原型</strong>，例如修改 Element.prototype 为所有元素添加一个新方法:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Element</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHi</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">`Hello, I&#x27;m <span class="subst">$&#123;<span class="variable language_">this</span>.tagName&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">sayHi</span>(); <span class="comment">// Hello, I&#x27;m HTML</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">sayHi</span>(); <span class="comment">// Hello, I&#x27;m BODY</span></span><br></pre></td></tr></table></figure>

<p>DOM 属性和方法的行为就像常规的 Javascript 对象一样：</p>
<ul>
<li>它们可以有很多值。</li>
<li>它们是大小写敏感的（要写成 elem.nodeType，而不是 elem.NoDeTyPe）。</li>
<li>DOM属性是多类型的，其大部分属性都是字符串类型，但也存在个例.<ul>
<li><p><code>input.checked</code>属性是Boolean型</p>
</li>
<li><p><code>style</code>特性是字符串类型，但其属性是一个对象</p>
</li>
<li><p><code>href</code>的属性一直是一个完整的URL，即使该特性包含一个相对路径或者包含一个 #hash。</p>
<h3 id="3-4-2-HTML特性"><a href="#3-4-2-HTML特性" class="headerlink" title="3.4.2 HTML特性"></a>3.4.2 HTML特性</h3><p>在HTML中，标签可能拥有特性（attributes）。当浏览器解析HTML文本，并根据标签创建DOM对象时，浏览器会辨别<strong>标准的</strong>特性并以此创建DOM属性。 所以，当一个元素有id或其他<strong>标准的</strong>特性，那么就会生成对应的DOM属性。但是<strong>非标准</strong>的特性则不会。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span> <span class="attr">something</span>=<span class="string">&quot;non-standard&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">alert</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">id</span>); <span class="comment">// test</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 非标准的特性没有获得对应的属性</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">alert</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">something</span>); <span class="comment">// undefined</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>一个元素的标准的特性对于另一个元素可能是未知的。</strong> “type” 是<code>&lt;input&gt;</code>的一个标准的特性（HTMLInputElement），但对于<code>&lt;body&gt;</code>（HTMLBodyElement）来说则不是。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">id</span>=<span class="string">&quot;body&quot;</span> <span class="attr">type</span>=<span class="string">&quot;...&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">alert</span>(input.<span class="property">type</span>); <span class="comment">// text</span></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">alert</span>(body.<span class="property">type</span>); <span class="comment">// undefined：DOM 属性没有被创建，因为它不是一个标准的特性</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p>所有特性都可以通过使用以下方法进行访问：</p>
<ul>
<li><code>elem.hasAttribute(name)</code> — 检查特性是否存在。</li>
<li><code>elem.getAttribute(name)</code> — 获取这个特性值。</li>
<li><code>elem.setAttribute(name, value)</code> — 设置这个特性值。</li>
<li><code>elem.removeAttribute(name)</code> — 移除这个特性。</li>
<li><code>elem.attributes</code> 读取所有特性：属于内建 Attr 类的对象的集合，具有 name 和 value 属性。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">something</span>=<span class="string">&quot;non-standard&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;something&#x27;</span>)); <span class="comment">// 非标准的</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>HTML 特性有以下几个特征：</p>
<ul>
<li>它们的名字是大小写不敏感的（id 与 ID 相同）。</li>
<li>它们的值总是字符串类型的。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span> <span class="attr">about</span>=<span class="string">&quot;Elephant&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>( elem.<span class="title function_">getAttribute</span>(<span class="string">&#x27;About&#x27;</span>) ); <span class="comment">// (1) &#x27;Elephant&#x27;，读取</span></span></span><br><span class="line"><span class="language-javascript">    elem.<span class="title function_">setAttribute</span>(<span class="string">&#x27;Test&#x27;</span>, <span class="number">123</span>); <span class="comment">// (2) 写入</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>( elem.<span class="property">outerHTML</span> ); <span class="comment">// (3) 查看特性是否在 HTML 中（在）</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span> (<span class="keyword">let</span> attr <span class="keyword">of</span> elem.<span class="property">attributes</span>) &#123; <span class="comment">// (4) 列出所有</span></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>( <span class="string">`<span class="subst">$&#123;attr.name&#125;</span> = <span class="subst">$&#123;attr.value&#125;</span>`</span> );</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>getAttribute(‘About’) — 这里的第一个字母是大写的，但是在 HTML 中，它们都是小写的。但这没有影响：特性的名称是大小写不敏感的。</li>
<li>我们可以将任何东西赋值给特性，但是这些东西会变成字符串类型的。所以这里我们的值为 “123”。</li>
<li>所有特性，包括我们设置的那个特性，在 outerHTML 中都是可见的。</li>
<li>attributes 集合是可迭代对象，该对象将所有元素的特性（标准和非标准的）作为 name 和 value 属性存储在对象中。</li>
</ol>
<h3 id="3-4-3-属性、特性同步"><a href="#3-4-3-属性、特性同步" class="headerlink" title="3.4.3 属性、特性同步"></a>3.4.3 属性、特性同步</h3><p>当一个标准的特性被改变，对应的属性也会自动更新，（除了几个特例）反之亦然。</p>
<p><code>input.value</code>只能从特性同步到属性，反过来则不行：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;input&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">let</span> input = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 特性 =&gt; 属性</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  input.<span class="title function_">setAttribute</span>(<span class="string">&#x27;value&#x27;</span>, <span class="string">&#x27;text&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">alert</span>(input.<span class="property">value</span>); <span class="comment">// text</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 这个操作无效，属性 =&gt; 特性</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  input.<span class="property">value</span> = <span class="string">&#x27;newValue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">alert</span>(input.<span class="title function_">getAttribute</span>(<span class="string">&#x27;value&#x27;</span>)); <span class="comment">// text（没有被更新！）</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<ul>
<li>改变特性值value会更新属性。</li>
<li>但是属性的更改不会影响特性。</li>
</ul>
<h3 id="3-4-4-非标准属性，dataset"><a href="#3-4-4-非标准属性，dataset" class="headerlink" title="3.4.4 非标准属性，dataset"></a>3.4.4 非标准属性，dataset</h3><p>非标准的特性常常用于将自定义的数据从 HTML 传递到 JavaScript，或者用于为 JavaScript “标记” HTML 元素。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 标记这个 div 以在这显示 &quot;name&quot; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">show-info</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 标记这个 div 以在这显示 &quot;age&quot; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">show-info</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 这段代码找到带有标记的元素，并显示需要的内容</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> user = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&quot;Pete&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: <span class="number">25</span></span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span>(<span class="keyword">let</span> div <span class="keyword">of</span> <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;[show-info]&#x27;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 在字段中插入相应的信息</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> field = div.<span class="title function_">getAttribute</span>(<span class="string">&#x27;show-info&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    div.<span class="property">innerHTML</span> = user[field]; <span class="comment">// 首先 &quot;name&quot; 变为 Pete，然后 &quot;age&quot; 变为 25</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>所有以 “data-” 开头的特性均被保留供程序员使用。它们可在 dataset 属性中使用。</strong> 例如，如果一个elem有一个名为 “data-about” 的特性，那么可以通过<code>elem.dataset.about</code>取到它。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">data-about</span>=<span class="string">&quot;Elephants&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">dataset</span>.<span class="property">about</span>); <span class="comment">// Elephants</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>像<code>data-order-state</code>这样的多词特性可以以驼峰式进行调用：<code>dataset.orderState</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.order</span><span class="selector-attr">[data-order-state=<span class="string">&quot;new&quot;</span>]</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: green;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.order</span><span class="selector-attr">[data-order-state=<span class="string">&quot;pending&quot;</span>]</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: blue;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.order</span><span class="selector-attr">[data-order-state=<span class="string">&quot;canceled&quot;</span>]</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;order&quot;</span> <span class="attr">class</span>=<span class="string">&quot;order&quot;</span> <span class="attr">data-order-state</span>=<span class="string">&quot;new&quot;</span>&gt;</span></span><br><span class="line">  A new order.</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 读取</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">alert</span>(order.<span class="property">dataset</span>.<span class="property">orderState</span>); <span class="comment">// new</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 修改</span></span></span><br><span class="line"><span class="language-javascript">  order.<span class="property">dataset</span>.<span class="property">orderState</span> = <span class="string">&quot;pending&quot;</span>; <span class="comment">// (*)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//这里的输出会是蓝色</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用<code>data-*</code>特性是一种合法且安全的传递自定义数据的方式。 请注意，我们不仅可以读取数据，还可以修改数据属性（data-attributes）。然后 CSS 会更新相应的视图：在上面这个例子中的最后一行 (*) 将颜色更改为了蓝色。</p>
<h3 id="3-5-修改文档（document）"><a href="#3-5-修改文档（document）" class="headerlink" title="3.5 修改文档（document）"></a>3.5 修改文档（document）</h3><p>要创建 DOM 节点，这里有两种方法： <code>document.createElement(tag)</code> –&gt; 用给定的标签创建一个<strong>新元素节点（element node）</strong> <code>document.createTextNode(text)</code> –&gt; 用给定的文本创建一个<strong>文本节点</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 创建 &lt;div&gt; 元素</span></span><br><span class="line"><span class="keyword">let</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line"><span class="comment">// 2. 将元素的类设置为 &quot;alert&quot;</span></span><br><span class="line">div.<span class="property">className</span> = <span class="string">&quot;alert&quot;</span>;</span><br><span class="line"><span class="comment">// 3. 填充消息内容</span></span><br><span class="line">div.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;strong&gt;Hi there!&lt;/strong&gt; You&#x27;ve read an important message.&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>通过这个方法，已经创建了元素，但是它目前在名为div的变量内，尚未在页面中，所以无法被看到。</p>
<p>如果想要使其在页面中显示出来，可以使用<code>append</code>方法 例如：<code>document.body.append(div)</code></p>
<p>当然，<strong>可以在其他任何元素上调用append方法</strong> 例如，通过调用<code>div.append(anotherElement)</code>，我们便可以在<code>&lt;div&gt;</code>末尾添加一些内容。</p>
<p>元素插入方法：</p>
<ul>
<li><code>node.append(...nodes or strings)</code> —— 在 node 末尾 插入节点或字符串，</li>
<li><code>node.prepend(...nodes or strings)</code> —— 在 node 开头 插入节点或字符串，</li>
<li><code>node.before(...nodes or strings)</code> —— 在 node 前面 插入节点或字符串，</li>
<li><code>node.after(...nodes or strings)</code> —— 在 node 后面 插入节点或字符串，</li>
<li><code>node.replaceWith(...nodes or strings)</code> —— 将 node 替换为给定的节点或字符串。</li>
</ul>
<p><strong>这些方法的参数可以是一个要插入的任意的 DOM 节点列表，或者文本字符串（会被自动转换成文本节点）。</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">id</span>=<span class="string">&quot;ol&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>0<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  ol.<span class="title function_">before</span>(<span class="string">&#x27;before&#x27;</span>); <span class="comment">// 将字符串 &quot;before&quot; 插入到 &lt;ol&gt; 前面</span></span></span><br><span class="line"><span class="language-javascript">  ol.<span class="title function_">after</span>(<span class="string">&#x27;after&#x27;</span>); <span class="comment">// 将字符串 &quot;after&quot; 插入到 &lt;ol&gt; 后面</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> liFirst = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  liFirst.<span class="property">innerHTML</span> = <span class="string">&#x27;prepend&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  ol.<span class="title function_">prepend</span>(liFirst); <span class="comment">// 将 liFirst 插入到 &lt;ol&gt; 的最开始</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> liLast = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  liLast.<span class="property">innerHTML</span> = <span class="string">&#x27;append&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">  ol.<span class="title function_">append</span>(liLast); <span class="comment">// 将 liLast 插入到 &lt;ol&gt; 的最末尾</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>因此，最终列表将为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">before</span><br><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">id</span>=<span class="string">&quot;ol&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>prepend<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>0<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>append<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">after</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;ul&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">getListContent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> result = [];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">1</span>; i&lt;=<span class="number">3</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> li = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    li.<span class="title function_">append</span>(i);</span></span><br><span class="line"><span class="language-javascript">    result.<span class="title function_">push</span>(li);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">return</span> result;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">ul.<span class="title function_">append</span>(...<span class="title function_">getListContent</span>()); <span class="comment">// append + &quot;...&quot; operator = friends!</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里出现了一个append(…)的方法，感觉这个方法应该是用来添加数组中内容的</p>
<h3 id="3-5-1-以html形式插入"><a href="#3-5-1-以html形式插入" class="headerlink" title="3.5.1 以html形式插入"></a>3.5.1 以html形式插入</h3><p>通过<code>elem.insertAdjacentHTML(where, html)</code>来插入html 该方法的第一个参数是<strong>代码字（code word）</strong>，指定相对于elem的插入位置。必须为以下之一：</p>
<ul>
<li><p><code>&quot;beforebegin&quot;</code> — 将 html 插入到 elem 前插入，</p>
</li>
<li><p><code>&quot;afterbegin&quot;</code> — 将 html 插入到 elem 开头，</p>
</li>
<li><p><code>&quot;beforeend&quot;</code> — 将 html 插入到 elem 末尾，</p>
</li>
<li><p><code>&quot;afterend&quot;</code> — 将 html 插入到 elem 后。 第二个参数是<strong>HTML字符串</strong>，该字符串会被“作为 HTML” 插入。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">div.<span class="title function_">insertAdjacentHTML</span>(<span class="string">&#x27;beforebegin&#x27;</span>, <span class="string">&#x27;&lt;p&gt;Hello&lt;/p&gt;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">div.<span class="title function_">insertAdjacentHTML</span>(<span class="string">&#x27;afterend&#x27;</span>, <span class="string">&#x27;&lt;p&gt;Bye&lt;/p&gt;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>结果为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;div&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Bye<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><code>elem.insertAdjacentText(where, text)</code> — 语法一样，但是将 text 字符串“作为文本”插入而不是作为 HTML， <code>elem.insertAdjacentElement(where, elem)</code> — 语法一样，但是插入的是一个元素。 它们的存在主要是为了使语法“统一”。 实际上，大多数时候只使用<code>insertAdjacentHTML</code>。因为对于元素和文本，我们有<code>append/prepend/before/after</code>方法。它们也可以用于插入节点&#x2F;文本片段，但写起来更短。</p>
<h3 id="3-5-2-节点移除"><a href="#3-5-2-节点移除" class="headerlink" title="3.5.2 节点移除"></a>3.5.2 节点移除</h3><p>想要移除一个节点，可以使用<code>node.remove()</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  div.<span class="property">className</span> = <span class="string">&quot;alert&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  div.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;strong&gt;Hi there!&lt;/strong&gt; You&#x27;ve read an important message.&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">append</span>(div);</span></span><br><span class="line"><span class="language-javascript">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> div.<span class="title function_">remove</span>(), <span class="number">1000</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>请注意：如果我们要将一个元素移动到另一个地方，则无需将其从原来的位置中删除。 <strong>所有插入方法都会自动从旧位置删除该节点。</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;first&quot;</span>&gt;</span>First<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;second&quot;</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 无需调用 remove</span></span></span><br><span class="line"><span class="language-javascript">  second.<span class="title function_">after</span>(first); <span class="comment">// 获取 #second，并在其后面插入 #first</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//进行了元素交换</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-5-3-克隆节点-cloneNode"><a href="#3-5-3-克隆节点-cloneNode" class="headerlink" title="3.5.3 克隆节点(cloneNode)"></a>3.5.3 克隆节点(cloneNode)</h3><p>调用<code>elem.cloneNode(true)</code>来创建元素的一个“深”克隆 — 具有所有特性（attribute）和子元素。 如果我们调用<code>elem.cloneNode(false)</code>，那克隆就不包括子元素。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;alert&quot;</span> <span class="attr">id</span>=<span class="string">&quot;div&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">strong</span>&gt;</span>Hi there!<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> You&#x27;ve read an important message.</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> div2 = div.<span class="title function_">cloneNode</span>(<span class="literal">true</span>); <span class="comment">// 克隆消息</span></span></span><br><span class="line"><span class="language-javascript">  div2.<span class="title function_">querySelector</span>(<span class="string">&#x27;strong&#x27;</span>).<span class="property">innerHTML</span> = <span class="string">&#x27;Bye there!&#x27;</span>; <span class="comment">// 修改克隆</span></span></span><br><span class="line"><span class="language-javascript">  div.<span class="title function_">after</span>(div2); <span class="comment">// 在已有的 div 后显示克隆</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-5-4-一些古老的方法"><a href="#3-5-4-一些古老的方法" class="headerlink" title="3.5.4 一些古老的方法"></a>3.5.4 一些古老的方法</h3><p><code>parentElem.appendChild(node)</code>将node加为parentElem的最后一个子元素。 <code>parentElem.insertBefore(node, nextSibling)</code>在parentElem的nextSibling前插入node。 <code>parentElem.replaceChild(node, oldChild)</code>将parentElem的后代中的oldChild替换为node。 <code>parentElem.removeChild(node)</code>从parentElem中删除node（假设node为parentElem的后代）。</p>
<p>一个非常古老的向网页添加内容的方法：<code>document.write</code> <strong>其调用时只在页面加载时工作。</strong> 要在页面加载完成之前将 HTML 附加到页面。 页面加载完成后，这样的调用将会擦除文档。多见于旧脚本。</p>
<h2 id="3-6-样式和类"><a href="#3-6-样式和类" class="headerlink" title="3.6 样式和类"></a>3.6 样式和类</h2><p><strong>更改类是脚本中最常见的操作之一。</strong> 对于类，引入了看起来类似的属性 “className”：elem.className 对应于 “class” 特性（attribute）。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;main page&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">className</span>); <span class="comment">// main page</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果我们对<code>elem.className</code>进行赋值，它将<strong>替换</strong>类中的<strong>整个字符串</strong>。有时，这正是我们所需要的，但通常我们希望添加&#x2F;删除单个类。</p>
<p><code>elem.classList</code>是一个特殊的对象,它具有 add&#x2F;remove&#x2F;toggle 单个类的方法。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;main page&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 添加一个 class</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;article&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">className</span>); <span class="comment">// main page article</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>因此，我们既可以使用<code>className</code>对完整的类字符串进行操作，也可以使用使用<code>classList</code>对单个类进行操作。我们选择什么取决于我们的需求。</p>
<p><code>classList</code> 的方法：</p>
<ul>
<li><code>elem.classList.add/remove(class)</code> — 添加&#x2F;移除类。</li>
<li><code>elem.classList.toggle(class)</code> — 如果类不存在就添加类，存在就移除它。</li>
<li><code>elem.classList.contains(class)</code> — 检查给定类，返回 true&#x2F;false。</li>
</ul>
<p>此外，classList 是可迭代的，因此，我们可以像下面这样列出所有类：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;main page&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span> (<span class="keyword">let</span> name <span class="keyword">of</span> <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(name); <span class="comment">// main，然后是 page</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-6-1-元素样式"><a href="#3-6-1-元素样式" class="headerlink" title="3.6.1 元素样式"></a>3.6.1 元素样式</h3><p>elem.style 属性是一个对象，它对应于 “style” 特性（attribute）中所写的内容。 elem.style.width&#x3D;”100px” 的效果等价于我们在 style 特性中有一个 width:100px 字符串。</p>
<p>对于多词（multi-word）属性，使用驼峰式 camelCase：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">background-color  =&gt; elem.style.backgroundColor</span><br><span class="line">z-index           =&gt; elem.style.zIndex</span><br><span class="line">border-left-width =&gt; elem.style.borderLeftWidth</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="title function_">prompt</span>(<span class="string">&#x27;background color?&#x27;</span>, <span class="string">&#x27;green&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>像<code>-moz-border-radius</code>和<code>-webkit-border-radius</code>这样的浏览器前缀属性，也遵循同样的规则： 连字符<code>-</code>表示大写。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">button.<span class="property">style</span>.<span class="property">MozBorderRadius</span> = <span class="string">&#x27;5px&#x27;</span>;</span><br><span class="line">button.<span class="property">style</span>.<span class="property">WebkitBorderRadius</span> = <span class="string">&#x27;5px&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-6-2-重置样式属性"><a href="#3-6-2-重置样式属性" class="headerlink" title="3.6.2 重置样式属性"></a>3.6.2 重置样式属性</h3><p>有时我们想要分配一个样式属性，稍后移除它。 例如，为了隐藏一个元素，我们可以设置<code>elem.style.display = &quot;none&quot;</code>。 然后，稍后我们可能想要移除<code>style.display</code>，就像它没有被设置一样。这里不应该使用<code>delete elem.style.display</code>，而应该使用<code>elem.style.display = &quot;&quot;</code>将其赋值为空。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果我们运行这段代码，&lt;body&gt; 将会闪烁</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>; <span class="comment">// 隐藏</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;&quot;</span>, <span class="number">1000</span>); <span class="comment">// 恢复正常</span></span><br></pre></td></tr></table></figure>

<p>如果我们将display设置为空字符串，那么浏览器通常会应用CSS类以及内建样式，<strong>就好像根本没有这样的style属性一样</strong>。</p>
<p>用<code>style.cssText</code>进行完全的重写 这是一种很危险的属性，因为它会删除现有的样式再进行替换，所以很少用 可以通过设置一个特性（attribute）来实现同样的效果：<code>div.setAttribute(&#39;style&#39;, &#39;color: red...&#39;)</code>。</p>
<h3 id="3-6-3-计算样式getComputedStyle"><a href="#3-6-3-计算样式getComputedStyle" class="headerlink" title="3.6.3 计算样式getComputedStyle"></a>3.6.3 计算样式getComputedStyle</h3><p>style 属性仅对 “style” 特性（attribute）值起作用，而没有任何CSS级联（cascade）。 因此我们无法使用<code>elem.style</code>读取来自CSS类的任何内容。 例如，这里的 style 看不到 margin：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"> <span class="selector-tag">body</span> &#123; <span class="attribute">color</span>: red; <span class="attribute">margin</span>: <span class="number">5px</span> &#125; </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  The red text</span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">color</span>); <span class="comment">// 空的</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">marginTop</span>); <span class="comment">// 空的</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>通过<code>getComputedStyle(element, [pseudo])</code>来获取元素的样式 <strong>element</strong>： 需要被读取样式值的元素 <strong>pseudo</strong>： 伪元素，例如<code>::before</code>。空字符串或无参数则意味着元素本身。</p>
<p>结果是一个具有样式属性的对象，像<code>elem.style</code>，但现在对于所有的 CSS 类来说都是如此</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"> <span class="selector-tag">body</span> &#123; <span class="attribute">color</span>: red; <span class="attribute">margin</span>: <span class="number">5px</span> &#125; </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> computedStyle = <span class="title function_">getComputedStyle</span>(<span class="variable language_">document</span>.<span class="property">body</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 现在我们可以读取它的 margin 和 color 了</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>( computedStyle.<span class="property">marginTop</span> ); <span class="comment">// 5px</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>( computedStyle.<span class="property">color</span> ); <span class="comment">// rgb(255, 0, 0)</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-7-元素大小和滚动"><a href="#3-7-元素大小和滚动" class="headerlink" title="3.7 元素大小和滚动"></a>3.7 元素大小和滚动</h2><h3 id="3-7-1-关于祖先的属性"><a href="#3-7-1-关于祖先的属性" class="headerlink" title="3.7.1 关于祖先的属性"></a>3.7.1 关于祖先的属性</h3><p><code>offsetParent</code> 定位最近的祖先：</p>
<ol>
<li>CSS 定位的（position 为 absolute，relative 或 fixed），</li>
<li>或 <code>&lt;td&gt;，&lt;th&gt;，&lt;table&gt;</code>，</li>
<li>或 <code>&lt;body&gt;</code>。</li>
</ol>
<p>属性<code>offsetLeft/offsetTop</code>提供相对于<code>offsetParent</code>左上角的 x&#x2F;y 坐标。</p>
<p>有以下几种情况下, <code>offsetParent</code>的值为 null： 对于未显示的元素（display:none 或者不在文档中）。 对于 <code>&lt;body&gt;</code> 与 <code>&lt;html&gt;</code>。 对于带有<code>position:fixed</code>的元素。</p>
<h3 id="3-7-2-关于元素本身的属性"><a href="#3-7-2-关于元素本身的属性" class="headerlink" title="3.7.2 关于元素本身的属性"></a>3.7.2 关于元素本身的属性</h3><h4 id="3-7-2-1-元素外部的属性"><a href="#3-7-2-1-元素外部的属性" class="headerlink" title="3.7.2.1 元素外部的属性"></a>3.7.2.1 元素外部的属性</h4><p><code>offsetWidth/Height</code>这两个属性是最简单的。它们提供了元素的“外部” width&#x2F;height。或者，换句话说，它的<strong>完整大小</strong>（包括边框）。 <strong>对于未显示的元素，几何属性为 0&#x2F;null</strong></p>
<h4 id="3-7-2-2-元素本身的属性"><a href="#3-7-2-2-元素本身的属性" class="headerlink" title="3.7.2.2 元素本身的属性"></a>3.7.2.2 元素本身的属性</h4><p>如果需要测量元素的<strong>边框</strong>(border)可以使用： <code>clientLeft</code> -&gt; 测量左边框宽度 <code>clientTop</code> -&gt; 测量上边框宽度 这些属性不是边框的 width&#x2F;height，而是<strong>内侧与外侧的相对坐标</strong>。 当文档从右到左显示（操作系统为阿拉伯语或希伯来语）时，影响就显现出来了。此时滚动条不在右边，而是在左边，此时<code>clientLeft</code>则包含了滚动条的宽度。</p>
<p><code>clientWidth/Height</code> 这些属性提供了元素边框内区域的大小。 它们包括了 “content width” 和 “padding”，但不包括滚动条宽度（scrollbar）。</p>
<p>如果这里没有 padding，那么 clientWidth&#x2F;Height 代表的就是内容区域。 即border和scrollbar（如果有）内的区域。</p>
<p><strong>因此，当没有 padding 时，我们可以使用 clientWidth&#x2F;clientHeight 来获取内容区域的大小。</strong></p>
<p><code>scrollWidth/Height</code>这些属性就像 clientWidth&#x2F;clientHeight，但它们还<strong>包括滚动（隐藏）的部分</strong>：</p>
<p>我们可以使用这些属性将元素展开（expand）到整个 width&#x2F;height。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将元素展开（expand）到完整的内容高度</span></span><br><span class="line">element.<span class="property">style</span>.<span class="property">height</span> = <span class="string">`<span class="subst">$&#123;element.scrollHeight&#125;</span>px`</span>;</span><br></pre></td></tr></table></figure>

<p><strong>所以可以用这个做展开全文吧</strong></p>
<p>属性<code>scrollLeft/scrollTop</code>是元素的隐藏、滚动部分的 width&#x2F;height。 <code>scrollTop</code>就是“已经滚动了多少”。 大多数几何属性是只读的，但是<code>scrollLeft/scrollTop</code>是可修改的，并且浏览器会滚动该元素。 将<code>scrollTop</code>设置为 0 或一个大的值，例如 1e9，将会使元素滚动到顶部&#x2F;底部。</p>
<hr>
<p><strong>不要直接读取CSS中的元素大小</strong></p>
<hr>
<h3 id="3-7-3-滚动"><a href="#3-7-3-滚动" class="headerlink" title="3.7.3 滚动"></a>3.7.3 滚动</h3><p>方法<code>scrollBy(x,y)</code>将页面滚动至相对于当前位置的(x, y)位置。例如，<code>scrollBy(0,10)</code>会将页面向下滚动10px。</p>
<p>方法<code>scrollTo(pageX,pageY)</code>将页面滚动至<strong>绝对坐标</strong>，使得可见部分的左上角具有相对于文档左上角的坐标 (pageX, pageY)。就像设置了scrollLeft&#x2F;scrollTop一样。</p>
<p><strong>要滚动到最开始，我们可以使用 scrollTo(0,0)。</strong> 这些方法适用于所有浏览器。</p>
<p><code>elem.scrollIntoView(top)</code>的调用将滚动页面以使elem可见。它有一个参数：</p>
<ul>
<li>如果 top&#x3D;true（默认值），页面滚动，使 elem 出现在窗口顶部。元素的上边缘将与窗口顶部对齐。</li>
<li>如果 top&#x3D;false，页面滚动，使 elem 出现在窗口底部。元素的底部边缘将与窗口底部对齐。 <code>this.scrollIntoView()</code>滚动页面，使其自身定位在窗口顶部 <code>this.scrollIntoView(false)</code>滚动页面，使其自身定位在窗口底部</li>
</ul>
<p><code>document.body.style.overflow = &quot;hidden&quot;</code> <strong>禁止滚动</strong> <code>document.body.style.overflow = &quot;&quot;</code> <strong>能够滚动</strong></p>
<h2 id="3-8-坐标"><a href="#3-8-坐标" class="headerlink" title="3.8 坐标"></a>3.8 坐标</h2><p>两个坐标系：</p>
<ol>
<li><strong>相对于窗口</strong> 类似于<code>position:fixed</code> 从窗口的顶部&#x2F;左侧边缘计算得出<ul>
<li>我们将这些坐标表示为 clientX&#x2F;clientY，当我们研究事件属性时，就会明白为什么使用这种名称来表示坐标。</li>
</ul>
</li>
<li><strong>相对于文档</strong> 与文档根（document root）中的<code>position:absolute</code>类似，从文档的顶部&#x2F;左侧边缘计算得出。<ul>
<li>我们将它们表示为 pageX&#x2F;pageY。</li>
</ul>
</li>
</ol>
<p>当页面滚动到最开始时，此时窗口的左上角恰好是文档的左上角，它们的坐标彼此相等。但是，在文档移动之后，<strong>元素的窗口相对坐标</strong>会发生变化，因为元素在窗口中移动，而<strong>元素在文档中的相对坐标</strong>保持不变。</p>
<p>在下图中，我们在文档中取一点，并演示了它滚动之前（左）和之后（右）的坐标：</p>
<p>当文档滚动了：</p>
<ul>
<li><code>pageY</code> — 元素在文档中的相对坐标保持不变，从文档顶部（现在已滚动出去）开始计算。</li>
<li><code>clientY</code> — 窗口相对坐标确实发生了变化（箭头变短了），因为同一个点越来越靠近窗口顶部。</li>
</ul>
<h3 id="3-8-1-元素坐标"><a href="#3-8-1-元素坐标" class="headerlink" title="3.8.1 元素坐标"></a>3.8.1 元素坐标</h3><p>方法<code>elem.getBoundingClientRect()</code>返回最小矩形的窗口坐标，该矩形将elem作为内建DOMRect类的对象。 主要的 DOMRect 属性：</p>
<ul>
<li>x&#x2F;y — 矩形原点相对于窗口的 X&#x2F;Y 坐标，</li>
<li>width&#x2F;height — 矩形的 width&#x2F;height（可以为负）。 此外，还有派生（derived）属性：</li>
<li>top&#x2F;bottom — 顶部&#x2F;底部矩形边缘的 Y 坐标，</li>
<li>left&#x2F;right — 左&#x2F;右矩形边缘的 X 坐标。</li>
</ul>
<p>对<code>document.elementFromPoint(x, y)</code>的调用会返回在窗口坐标 (x, y) 处嵌套最多（the most nested）的元素。</p>
<p>下面的代码会高亮显示并输出现在位于窗口中间的元素的标签：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> centerX = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span> / <span class="number">2</span>;</span><br><span class="line"><span class="keyword">let</span> centerY = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span> / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> elem = <span class="variable language_">document</span>.<span class="title function_">elementFromPoint</span>(centerX, centerY);</span><br><span class="line"></span><br><span class="line">elem.<span class="property">style</span>.<span class="property">background</span> = <span class="string">&quot;red&quot;</span>;</span><br><span class="line"><span class="title function_">alert</span>(elem.<span class="property">tagName</span>);</span><br></pre></td></tr></table></figure>

<p><strong>因为它使用的是窗口坐标，所以元素可能会因当前滚动位置而有所不同。</strong></p>
<p>对于在窗口之外的坐标，<code>elementFromPoint</code>返回<strong>null</strong></p>
<h3 id="3-8-2-用于“fixed”定位"><a href="#3-8-2-用于“fixed”定位" class="headerlink" title="3.8.2 用于“fixed”定位"></a>3.8.2 用于“fixed”定位</h3><p>为了显示元素附近的东西，我们可以使用<code>getBoundingClientRect</code>来获取其坐标，然后使用<code>CSS position</code>以及left&#x2F;top（或 right&#x2F;bottom）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> elem = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;coords-show-mark&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createMessageUnder</span>(<span class="params">elem, html</span>) &#123;</span><br><span class="line">  <span class="comment">// 创建 message 元素</span></span><br><span class="line">  <span class="keyword">let</span> message = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">  <span class="comment">// 在这里最好使用 CSS class 来定义样式</span></span><br><span class="line">  message.<span class="property">style</span>.<span class="property">cssText</span> = <span class="string">&quot;position:fixed; color: red&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 分配坐标，不要忘记 &quot;px&quot;！</span></span><br><span class="line">  <span class="keyword">let</span> coords = elem.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line"></span><br><span class="line">  message.<span class="property">style</span>.<span class="property">left</span> = coords.<span class="property">left</span> + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">  message.<span class="property">style</span>.<span class="property">top</span> = coords.<span class="property">bottom</span> + <span class="string">&quot;px&quot;</span>;</span><br><span class="line"></span><br><span class="line">  message.<span class="property">innerHTML</span> = html;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> message;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用法：</span></span><br><span class="line"><span class="comment">// 在文档中添加 message 保持 5 秒</span></span><br><span class="line"><span class="keyword">let</span> message = <span class="title function_">createMessageUnder</span>(elem, <span class="string">&#x27;Hello, world!&#x27;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">append</span>(message);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> message.<span class="title function_">remove</span>(), <span class="number">5000</span>);</span><br></pre></td></tr></table></figure>

<p>页面上的任何点都有坐标：</p>
<p><strong>相对于窗口的坐标 — elem.getBoundingClientRect()。</strong> <strong>相对于文档的坐标 — elem.getBoundingClientRect() 加上当前页面滚动。</strong> 窗口坐标非常适合和 position:fixed 一起使用，文档坐标非常适合和 position:absolute 一起使用。 这两个坐标系统各有利弊。有时我们需要其中一个或另一个，就像 CSS position 的 absolute 和 fixed 一样。</p>
<h1 id="4-浏览器事件简介"><a href="#4-浏览器事件简介" class="headerlink" title="4 浏览器事件简介"></a>4 浏览器事件简介</h1><ul>
<li><p><strong>鼠标事件</strong>：</p>
<ul>
<li><code>click</code> —— 当鼠标点击一个元素时（触摸屏设备会在点击时生成）</li>
<li><code>contextmenu</code> —— 当鼠标右键点击一个元素时。</li>
<li><code>mouseover / mouseout</code> —— 当鼠标指针移入&#x2F;离开一个元素时。</li>
<li><code>mousedown / mouseup</code> —— 当在元素上按下&#x2F;释放鼠标按钮时。</li>
<li><code>mousemove</code> —— 当鼠标移动时。</li>
</ul>
</li>
<li><p><strong>键盘事件</strong>：</p>
<ul>
<li><code>keydown</code> 和 <code>keyup</code> —— 当按下和松开一个按键时。</li>
</ul>
</li>
<li><p><strong>表单（form）元素事件</strong>：</p>
<ul>
<li><code>submit</code> —— 当访问者提交了一个 <code>&lt;form&gt;</code> 时。</li>
<li><code>focus</code> —— 当访问者聚焦于一个元素时，例如聚焦于一个<code>&lt;input&gt;</code>。</li>
</ul>
</li>
<li><p><strong>Document事件</strong>：</p>
<ul>
<li><code>DOMContentLoaded</code> —— 当HTML的加载和处理均完成，DOM 被完全构建完成时。</li>
</ul>
</li>
<li><p><strong>CSS事件</strong>：</p>
<ul>
<li><code>transitionend</code> —— 当一个 CSS 动画完成时。</li>
</ul>
</li>
</ul>
<h2 id="4-1-事件处理程序"><a href="#4-1-事件处理程序" class="headerlink" title="4.1 事件处理程序"></a>4.1 事件处理程序</h2><p>为了对事件作出响应，我们可以分配一个 <strong>处理程序（handler）</strong>—— 一个在事件发生时运行的函数。 处理程序是在发生用户行为（action）时运行JavaScript代码的一种方式。</p>
<h3 id="4-1-1-HTML特性"><a href="#4-1-1-HTML特性" class="headerlink" title="4.1.1 HTML特性"></a>4.1.1 HTML特性</h3><p>处理程序可以设置在HTML中名为 <code>on&lt;event&gt;</code> 的特性（attribute）中。 <code>&lt;input value=&quot;Click me&quot; onclick=&quot;alert(&#39;Click!&#39;)&quot; type=&quot;button&quot;&gt;</code> 也就是为button绑定了一个点击特性 请注意，在<code>onclick</code>中，我们使用单引号，因为特性本身使用的是双引号。如果我们忘记了代码是在特性中的，而使用了双引号，像这样：<code>onclick=&quot;alert(&quot;Click!&quot;)&quot;</code>，那么它就无法正确运行。</p>
<p><strong>HTML特性不是编写大量代码的好位置，因此我们最好创建一个 JavaScript 函数，然后在 HTML 特性中调用这个函数。</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">countRabbits</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">1</span>; i&lt;=<span class="number">3</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="string">&quot;Rabbit number &quot;</span> + i);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;countRabbits()&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Count rabbits!&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-1-2-DOM属性"><a href="#4-1-2-DOM属性" class="headerlink" title="4.1.2 DOM属性"></a>4.1.2 DOM属性</h3><p>我们可以使用DOM属性（property）<code>on&lt;event&gt;</code>来分配处理程序。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Click me&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  elem.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;Thank you&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果一个处理程序是通过HTML特性（attribute）分配的，那么随后浏览器读取它，并从特性的内容创建一个新函数，并将这个函数写入DOM属性（property）。</p>
<p><strong>所以说这两种方法本质上是一样的</strong> 唯一的区别就是初始化方法不一样，一个是通过HTML特性初始化的，另一个是通过脚本初始化的。</p>
<p>可以通过给js中添加处理程序，覆盖现有的处理程序。</p>
<p>要移除一个处理程序 —— 赋值<code>elem.onclick = null</code>。</p>
<h3 id="4-1-3-this元素"><a href="#4-1-3-this元素" class="headerlink" title="4.1.3 this元素"></a>4.1.3 this元素</h3><p>处理程序中的this的值是对应的元素。就是处理程序所在的那个元素。 <code>&lt;button onclick=&quot;alert(this.innerHTML)&quot;&gt;Click me&lt;/button&gt;</code> 这里显示的是click me，也就是标签里的内容</p>
<h3 id="4-1-4-一些需要注意的点"><a href="#4-1-4-一些需要注意的点" class="headerlink" title="4.1.4 一些需要注意的点"></a>4.1.4 一些需要注意的点</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sayThanks</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;Thanks!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">elem.<span class="property">onclick</span> = sayThanks;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确</span></span><br><span class="line">button.<span class="property">onclick</span> = sayThanks;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误</span></span><br><span class="line">button.<span class="property">onclick</span> = <span class="title function_">sayThanks</span>();</span><br></pre></td></tr></table></figure>

<p>这是很关键的，如果加括号，则为调用函数，那么它需要得到函数执行的结果，因为它没有返回值，所以是undefined</p>
<p><strong>但在标记（markup）中，我们确实需要括号：</strong> <code>&lt;input type=&quot;button&quot; id=&quot;button&quot; onclick=&quot;sayThanks()&quot;&gt;</code></p>
<p><strong>不要对处理程序使用<code>setAttribute</code>。</strong></p>
<p><strong>DOM 属性是大小写敏感的。</strong> 所以<strong>不能</strong>使用<code>elem.ONCLICK</code></p>
<h3 id="4-1-5-addEventListener"><a href="#4-1-5-addEventListener" class="headerlink" title="4.1.5 addEventListener"></a>4.1.5 addEventListener</h3><p>如果需要对一个事件分配多个处理程序 则需要使用<code>addEventListener</code> 和<code>removeEventListener</code>来管理处理程序</p>
<p><code>element.addEventListener(event, handler[, options]);</code></p>
<p>event : 事件名，例如：‘click’</p>
<p>handler : 处理程序</p>
<p>options ： 可附加对象</p>
<ul>
<li>once：如果为 true，那么会在被触发后自动删除监听器。</li>
<li>capture：事件处理的阶段。由于历史原因，options 也可以是 false&#x2F;true，它与 {capture: false&#x2F;true} 相同。</li>
<li>passive：如果为 true，那么处理程序将不会调用 preventDefault()</li>
</ul>
<p><strong>移除需要相同的函数：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">handler</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>( <span class="string">&#x27;Thanks!&#x27;</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">input.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, handler);</span><br><span class="line"><span class="comment">// ....</span></span><br><span class="line">input.<span class="title function_">removeEventListener</span>(<span class="string">&quot;click&quot;</span>, handler);</span><br></pre></td></tr></table></figure>

<p>多次调用<code>addEventListener</code>允许添加多个处理程序，如下所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Click me&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handler1</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;Thanks!&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handler2</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&#x27;Thanks again!&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  elem.<span class="property">onclick</span> = <span class="function">() =&gt;</span> <span class="title function_">alert</span>(<span class="string">&quot;Hello&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  elem.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, handler1); <span class="comment">// Thanks!</span></span></span><br><span class="line"><span class="language-javascript">  elem.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, handler2); <span class="comment">// Thanks again!</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对于某些事件，只能通过<code>addEventListener</code>设置处理程序 例如<code>DOMContentLoaded</code>事件，该事件在文档加载完成并且 DOM 构建完成时触发。</p>
<h3 id="4-1-6-事件对象"><a href="#4-1-6-事件对象" class="headerlink" title="4.1.6 事件对象"></a>4.1.6 事件对象</h3><p><strong>当事件发生时，浏览器会创建一个<code>event</code>对象，将详细信息放入其中，并将其作为参数传递给处理程序。</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Click me&quot;</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  elem.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 显示事件类型、元素和点击的坐标</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(event.<span class="property">type</span> + <span class="string">&quot; at &quot;</span> + event.<span class="property">currentTarget</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&quot;Coordinates: &quot;</span> + event.<span class="property">clientX</span> + <span class="string">&quot;:&quot;</span> + event.<span class="property">clientY</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>event.type</strong> 事件类型，这里是 “click”。 <strong>event.currentTarget</strong> 处理事件的元素。这与 this 相同，除非处理程序是一个箭头函数，或者它的 this 被绑定到了其他东西上，之后我们就可以从 event.currentTarget 获取元素了。 <strong>event.clientX &#x2F; event.clientY</strong> 指针事件（pointer event）的指针的窗口相对坐标。</p>
<p>event对象在HTML特性或者是DOM属性中都能够被使用</p>
<h3 id="4-1-7-对象处理程序"><a href="#4-1-7-对象处理程序" class="headerlink" title="4.1.7 对象处理程序"></a>4.1.7 对象处理程序</h3><p>我们不仅可以分配函数，还可以使用<code>addEventListener</code>将一个对象分配为事件处理程序。当事件发生时，就会调用该对象的<code>handleEvent</code>方法。</p>
<p>当<code>addEventListener</code>接收一个对象作为处理程序时，在事件发生时，它就会调用<code>obj.handleEvent(event)</code>来处理事件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">class</span> <span class="title class_">Menu</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">handleEvent</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">switch</span>(event.<span class="property">type</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">case</span> <span class="string">&#x27;mousedown&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">          elem.<span class="property">innerHTML</span> = <span class="string">&quot;Mouse button pressed&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">case</span> <span class="string">&#x27;mouseup&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">          elem.<span class="property">innerHTML</span> += <span class="string">&quot;...and released.&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> menu = <span class="keyword">new</span> <span class="title class_">Menu</span>();</span></span><br><span class="line"><span class="language-javascript">  elem.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, menu);</span></span><br><span class="line"><span class="language-javascript">  elem.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, menu);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-2-冒泡和捕获"><a href="#4-2-冒泡和捕获" class="headerlink" title="4.2 冒泡和捕获"></a>4.2 冒泡和捕获</h2><h3 id="4-2-1-冒泡-bubbing"><a href="#4-2-1-冒泡-bubbing" class="headerlink" title="4.2.1 冒泡(bubbing)"></a>4.2.1 冒泡(bubbing)</h3><p>当一个事件发生在一个元素上，它会首先运行在该元素上的处理程序，然后运行其父元素上的处理程序，然后一直向上到其他祖先上的处理程序。 假设我们有 3 层嵌套 <code>FORM &gt; DIV &gt; P</code>，它们各自拥有一个处理程序：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">body</span> * &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border</span>: <span class="number">1px</span> solid blue;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(&#x27;form&#x27;)&quot;</span>&gt;</span>FORM</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(&#x27;div&#x27;)&quot;</span>&gt;</span>DIV</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(&#x27;p&#x27;)&quot;</span>&gt;</span>P<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击内部的<code>&lt;p&gt;</code>会首先运行<code>onclick</code>：</p>
<ol>
<li>在该<code>&lt;p&gt;</code>上的。</li>
<li>然后是外部<code>&lt;div&gt;</code>上的。</li>
<li>然后是外部<code>&lt;form&gt;</code>上的。</li>
<li>以此类推，直到最后的<code>document</code>对象。</li>
</ol>
<p>因此，如果我们点击<code>&lt;p&gt;</code>，那么我们将看到 3 个 alert：p → div → form。</p>
<p><strong>这个过程被称为“冒泡（bubbling）”，因为事件从内部元素“冒泡”到所有父级，就像在水里的气泡一样。</strong></p>
<p><strong>几乎</strong>所有事件都会冒泡。 例如，<code>focus</code>事件不会冒泡。同样，我们以后还会遇到其他例子。但这仍然是例外，而不是规则，大多数事件的确都是冒泡的。</p>
<h3 id="4-2-2-event-target"><a href="#4-2-2-event-target" class="headerlink" title="4.2.2 event.target"></a>4.2.2 event.target</h3><p>父元素上的处理程序始终可以获取事件实际发生位置的详细信息。 引发事件的那个嵌套层级最深的元素被称为目标元素,可以通过<code>event.target</code>访问。</p>
<p>this和event.target的区别：</p>
<ul>
<li><code>event.target</code> —— 是引发事件的“目标”元素，它在冒泡过程中不会发生变化。</li>
<li><code>this</code> —— 是“当前”元素，其中有一个当前正在运行的处理程序。</li>
</ul>
<p>在一个事件中，this代表的元素就是这个事件的元素，而event.target则不一定，它可能是这个事件的子元素</p>
<h3 id="4-2-3-停止冒泡"><a href="#4-2-3-停止冒泡" class="headerlink" title="4.2.3 停止冒泡"></a>4.2.3 停止冒泡</h3><p>冒泡事件从目标元素开始向上冒泡。通常，它会一直上升到<code>&lt;html&gt;</code>，然后再到<code>document</code>对象，有些事件甚至会到达 <code>window</code>，它们会调用路径上所有的处理程序。</p>
<p><strong>但是任意处理程序都可以决定事件已经被完全处理，并停止冒泡。</strong></p>
<p>用于停止冒泡的方法是<code>event.stopPropagation()</code>。</p>
<p>如果一个元素在一个事件上有多个处理程序，即使其中一个停止冒泡，其他处理程序仍会执行。 换句话说，<code>event.stopPropagation()</code>停止向上移动，但是当前元素上的其他处理程序都会继续运行。 有一个<code>event.stopImmediatePropagation()</code>方法，可以用于停止冒泡，并阻止当前元素上的处理程序运行。使用该方法之后，其他处理程序就不会被执行。</p>
<p><strong>不要在没有需要的情况下停止冒泡！</strong></p>
<p>通常，没有真正的必要去阻止冒泡。一项看似需要阻止冒泡的任务，可以通过其他方法解决。其中之一就是使用自定义事件，我们还可以将我们的数据写入一个处理程序中的<code>event</code>对象，并在另一个处理程序中读取该数据，这样我们就可以向父处理程序传递有关下层处理程序的信息。</p>
<h3 id="4-2-4-捕获"><a href="#4-2-4-捕获" class="headerlink" title="4.2.4 捕获"></a>4.2.4 捕获</h3><p>事件处理的另一个阶段被称为“捕获（capturing）”。它很少被用在实际开发中，但有时是有用的。</p>
<p>DOM 事件标准描述了事件传播的 3 个阶段：</p>
<ol>
<li>捕获阶段（Capturing phase）—— 事件（从 Window）向下走近元素。</li>
<li>目标阶段（Target phase）—— 事件到达目标元素。</li>
<li>冒泡阶段（Bubbling phase）—— 事件从元素上开始冒泡。</li>
</ol>
<h2 id="4-3-事件委托"><a href="#4-3-事件委托" class="headerlink" title="4.3 事件委托"></a>4.3 事件委托</h2><p>捕获和冒泡允许我们实现最强大的事件处理模式之一，即<strong>事件委托</strong>模式。</p>
<p>如果我们有许多以<strong>类似方式</strong>处理的元素，那么就不必为每个元素分配一个处理程序 —— 而是<strong>将单个处理程序放在它们的共同祖先上</strong>。</p>
<p>在处理程序中，我们获取<code>event.target</code>以查看事件实际发生的位置并进行处理。</p>
<h3 id="4-3-1-标记中的行为-action-in-markup"><a href="#4-3-1-标记中的行为-action-in-markup" class="headerlink" title="4.3.1 标记中的行为(action in markup)"></a>4.3.1 标记中的行为(action in markup)</h3><p>例如，我们想要编写一个有“保存”、“加载”和“搜索”等按钮的菜单。并且，这里有一个具有 save、load 和 search 等方法的对象。如何匹配它们？ 第一个想法可能是为每个按钮分配一个单独的处理程序。但是有一个更优雅的解决方案。我们可以为整个菜单添加一个处理程序，并为具有方法调用的按钮添加 data-action 特性（attribute）： <code>&lt;button data-action=&quot;save&quot;&gt;Click to Save&lt;/button&gt;</code></p>
<p>处理程序读取特性（attribute）并执行该方法。工作示例如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;menu&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">data-action</span>=<span class="string">&quot;save&quot;</span>&gt;</span>Save<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">data-action</span>=<span class="string">&quot;load&quot;</span>&gt;</span>Load<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">data-action</span>=<span class="string">&quot;search&quot;</span>&gt;</span>Search<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">class</span> <span class="title class_">Menu</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">constructor</span>(<span class="params">elem</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">_elem</span> = elem;</span></span><br><span class="line"><span class="language-javascript">      elem.<span class="property">onclick</span> = <span class="variable language_">this</span>.<span class="property">onClick</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>); <span class="comment">// (*)</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">save</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="string">&#x27;saving&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">load</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="string">&#x27;loading&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">search</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="string">&#x27;searching&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">onClick</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> action = event.<span class="property">target</span>.<span class="property">dataset</span>.<span class="property">action</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (action) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>[action]();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">new</span> <span class="title class_">Menu</span>(menu);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>我们不需要编写代码来为每个按钮分配一个处理程序。只需要创建一个方法并将其放入标记（markup）中即可。</li>
<li>HTML 结构非常灵活，我们可以随时添加&#x2F;移除按钮。</li>
</ul>
<h3 id="4-3-2-行为模式"><a href="#4-3-2-行为模式" class="headerlink" title="4.3.2 行为模式"></a>4.3.2 行为模式</h3><p>我们还可以使用事件委托将“行为（behavior）”以 声明方式 添加到具有特殊特性（attribute）和类的元素中。 行为模式分为两个部分：</p>
<ul>
<li>我们将自定义特性添加到描述其行为的元素。</li>
<li>用文档范围级的处理程序追踪事件，如果事件发生在具有特定特性的元素上 —— 则执行行为（action）。</li>
</ul>
<p><strong>行为：计数器</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Counter: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">data-counter</span>&gt;</span></span><br><span class="line">One more counter: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span> <span class="attr">data-counter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (event.<span class="property">target</span>.<span class="property">dataset</span>.<span class="property">counter</span> != <span class="literal">undefined</span>) &#123; <span class="comment">// 如果这个特性存在...</span></span></span><br><span class="line"><span class="language-javascript">      event.<span class="property">target</span>.<span class="property">value</span>++;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对于文档级的处理程序 —— 始终使用的是<code>addEventListener</code> 当我们将事件处理程序分配给<code>document</code>对象时，我们应该始终使用<code>addEventListener</code>，而不是<code>document.on&lt;event&gt;</code>，因为后者会引起冲突：新的处理程序会覆盖旧的处理程序。</p>
<p>对于实际项目来说。在<code>document</code>上有许多由代码的不同部分设置的处理程序，这是很正常的。</p>
<p><strong>行为：切换器</strong> 点击一个具有 data-toggle-id 特性的元素将显示&#x2F;隐藏具有给定 id 的元素：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">button data-toggle-id=&quot;subscribe-mail&quot;&gt;</span><br><span class="line">  Show the subscription form</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;subscribe-mail&quot;</span> <span class="attr">hidden</span>&gt;</span></span><br><span class="line">  Your mail: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> id = event.<span class="property">target</span>.<span class="property">dataset</span>.<span class="property">toggleId</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!id) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> elem = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    elem.<span class="property">hidden</span> = !elem.<span class="property">hidden</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>让我们再次注意我们做了什么。现在，要向元素添加切换功能 —— 无需了解JavaScript，只需要使用特性<code>data-toggle-id</code> 即可。 这可能变得非常方便 —— 无需为每个这样的元素编写 JavaScript。只需要使用行为。文档级处理程序使其适用于页面的任意元素。</p>
<p><strong>我们也可以组合单个元素上的多个行为。</strong></p>
<p><strong>“行为”模式可以替代 JavaScript 的小片段。</strong></p>
<h3 id="4-3-3-总结"><a href="#4-3-3-总结" class="headerlink" title="4.3.3 总结"></a>4.3.3 总结</h3><p><strong>它通常用于为许多相似的元素添加相同的处理，但不仅限于此。</strong></p>
<ol>
<li>在容器（container）上放一个处理程序。</li>
<li>在处理程序中 —— 检查源元素 event.target。</li>
<li>如果事件发生在我们感兴趣的元素内，那么处理该事件。</li>
</ol>
<p>好处：</p>
<ul>
<li>简化初始化并节省内存：无需添加许多处理程序。</li>
<li>更少的代码：添加或移除元素时，无需添加&#x2F;移除处理程序。</li>
<li>DOM 修改 ：我们可以使用 innerHTML 等，来批量添加&#x2F;移除元素。</li>
</ul>
<p>局限：</p>
<ul>
<li>首先，事件必须冒泡。而有些事件不会冒泡。此外，低级别的处理程序不应该使用 event.stopPropagation()。</li>
<li>其次，委托可能会增加 CPU 负载，因为容器级别的处理程序会对容器中任意位置的事件做出反应，而不管我们是否对该事件感兴趣。但是，通常负载可以忽略不计，所以我们不考虑它。</li>
</ul>
<h2 id="4-4-浏览器默认行为"><a href="#4-4-浏览器默认行为" class="headerlink" title="4.4 浏览器默认行为"></a>4.4 浏览器默认行为</h2><p>许多事件会自动触发浏览器执行某些行为。</p>
<p>例如：</p>
<ul>
<li>点击一个链接 —— 触发导航（navigation）到该 URL。</li>
<li>点击表单的提交按钮 —— 触发提交到服务器的行为。</li>
<li>在文本上按下鼠标按钮并移动 —— 选中文本。</li>
</ul>
<p>如果我们使用 JavaScript 处理一个事件，那么我们通常不希望发生相应的浏览器行为。而是想要实现其他行为进行替代。</p>
<h3 id="4-4-1-阻止浏览器行为"><a href="#4-4-1-阻止浏览器行为" class="headerlink" title="4.4.1 阻止浏览器行为"></a>4.4.1 阻止浏览器行为</h3><p>有两种方式来告诉浏览器我们不希望它执行默认行为：</p>
<p>主流的方式是使用<code>event</code>对象。有一个<code>event.preventDefault()</code>方法。 如果处理程序是使用<code>on&lt;event&gt;</code>（而不是<code>addEventListener</code>）分配的，那返回<code>false</code>也同样有效。 在下面这个示例中，点击链接不会触发导航（navigation），浏览器不会执行任何操作：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;return false&quot;</span>&gt;</span>Click here<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">or</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;event.preventDefault()&quot;</span>&gt;</span>here<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>从处理程序返回<code>false</code>是一个例外 事件处理程序返回的值通常会被忽略。 唯一的例外是从使用<code>on&lt;event&gt;</code>分配的处理程序中返回的 return false。 在所有其他情况下，return 值都会被忽略。并且，返回 true 没有意义。</p>
<h3 id="4-4-2-处理程序选项“passive”"><a href="#4-4-2-处理程序选项“passive”" class="headerlink" title="4.4.2 处理程序选项“passive”"></a>4.4.2 处理程序选项“passive”</h3><p><code>addEventListener</code>的可选项<code>passive: true</code>向浏览器发出信号，表明处理程序将不会调用<code>preventDefault()</code>。</p>
<p>为什么需要这样做？</p>
<p>移动设备上会发生一些事件，例如<code>touchmove</code>（当用户在屏幕上移动手指时），默认情况下会导致滚动，但是可以使用处理程序的<code>preventDefault()</code>来阻止滚动。</p>
<p>因此，当浏览器检测到此类事件时，它必须首先处理所有处理程序，然后如果没有任何地方调用<code>preventDefault</code>，则页面可以继续滚动。但这可能会导致 UI 中不必要的延迟和“抖动”。</p>
<p><code>passive: true</code>选项告诉浏览器，处理程序不会取消滚动。然后浏览器立即滚动页面以提供最大程度的流畅体验，并通过某种方式处理事件。</p>
<p>对于某些浏览器（Firefox，Chrome），默认情况下，<code>touchstart</code>和<code>touchmove</code>事件的<code>passive</code>为 true。</p>
<h3 id="4-4-3-event-defaultPrevented"><a href="#4-4-3-event-defaultPrevented" class="headerlink" title="4.4.3 event.defaultPrevented"></a>4.4.3 event.defaultPrevented</h3><p>如果默认行为被阻止，那么<code>event.defaultPrevented</code>属性为<code>true</code>，否则为<code>false</code>。</p>
<p>在冒泡和捕获中的 event.stopPropagation()，可以使用<code>event.defaultPrevented</code>来代替，来通知其他事件处理程序，该事件已经被处理。</p>
<p>默认情况下，浏览器在<code>contextmenu</code>事件（单击鼠标右键）时，显示带有标准选项的上下文菜单。我们可以阻止它并显示我们自定义的菜单，就像这样：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>Right-click shows browser context menu<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">oncontextmenu</span>=<span class="string">&quot;alert(&#x27;Draw our menu&#x27;); return false&quot;</span>&gt;</span></span><br><span class="line">  Right-click shows our context menu</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Right-click for the document menu (added a check for event.defaultPrevented)<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span>&gt;</span>Right-click for the button menu<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  elem.<span class="property">oncontextmenu</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    event.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&quot;Button context menu&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="property">oncontextmenu</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (event.<span class="property">defaultPrevented</span>) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    event.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&quot;Document context menu&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>现在一切都可以正常工作了。如果我们有嵌套的元素，并且每个元素都有自己的上下文菜单，那么这也是可以运行的。只需确保检查每个<code>contextmenu</code>处理程序中的<code>event.defaultPrevented</code>。</p>
<p><code>event.stopPropagation()</code> 和 <code>event.preventDefault()</code> 正如我们所看到的，<code>event.stopPropagation()</code>和<code>event.preventDefault()</code>（也被认为是 return false）是两个不同的东西。它们之间毫无关联。</p>
<h2 id="4-5-创建自定义事件"><a href="#4-5-创建自定义事件" class="headerlink" title="4.5 创建自定义事件"></a>4.5 创建自定义事件</h2><p>我们不仅可以分配事件处理程序，还可以从JavaScript生成事件。</p>
<p>自定义事件可用于创建“图形组件”。例如，我们自己的基于JavaScript的菜单的根元素可能会触发<code>open</code>（打开菜单），<code>select</code>（有一项被选中）等事件来告诉菜单发生了什么。另一个代码可能会监听事件，并观察菜单发生了什么。</p>
<p>我们不仅可以生成出于自身目的而创建的全新事件，还可以生成例如<code>click</code>和<code>mousedown</code>等内建事件。这可能会有助于自动化测试。</p>
<h3 id="4-5-1-事件构造器"><a href="#4-5-1-事件构造器" class="headerlink" title="4.5.1 事件构造器"></a>4.5.1 事件构造器</h3><p>内建事件类形成一个层次结构（hierarchy），类似于DOM元素类。根是内建的<code>Event</code>类。</p>
<p>我们可以像这样创建<code>Event</code>对象： <code>let event = new Event(type[, options]);</code> 参数：</p>
<ul>
<li><strong>type</strong> —— 事件类型，可以是像这样 “click” 的字符串，或者我们自己的像这样 “my-event” 的参数。</li>
<li><strong>options</strong> —— 具有两个可选属性的对象：<ul>
<li>bubbles: true&#x2F;false —— 如果为 true，那么事件会冒泡。</li>
<li>cancelable: true&#x2F;false —— 如果为 true，那么“默认行为”就会被阻止。稍后我们会看到对于自定义事件，它意味着什么。 默认情况下，以上两者都为 false：{bubbles: false, cancelable: false}。</li>
</ul>
</li>
</ul>
<h3 id="4-5-2-dispatchEvent"><a href="#4-5-2-dispatchEvent" class="headerlink" title="4.5.2 dispatchEvent"></a>4.5.2 dispatchEvent</h3><p>事件对象被创建后，我们应该使用<code>elem.dispatchEvent(event)</code> 调用在元素上“运行”它。</p>
<p>然后，处理程序会对它做出反应，就好像它是一个常规的浏览器事件一样。如果事件是用<code>bubbles</code>标志创建的，那么它会冒泡。</p>
<p>在下面这个示例中，<code>click</code>事件是用JavaScript初始化创建的。处理程序工作方式和点击按钮的方式相同：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(&#x27;Click!&#x27;);&quot;</span>&gt;</span>Autoclick<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> event = <span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;click&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  elem.<span class="title function_">dispatchEvent</span>(event);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>event.isTrusted</code>可以用来区分“真实”用户事件和通过脚本生成的事件。 对于来自真实用户操作的事件，<code>event.isTrusted</code>属性为true。 对于脚本生成的事件，<code>event.isTrusted</code>属性为 false。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span>&gt;</span>Hello from the script!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 在 document 上捕获...</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;hello&quot;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123; <span class="comment">// (1)</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&quot;Hello from &quot;</span> + event.<span class="property">target</span>.<span class="property">tagName</span>); <span class="comment">// Hello from H1</span></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// ...在 elem 上 dispatch！</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> event = <span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;hello&quot;</span>, &#123;<span class="attr">bubbles</span>: <span class="literal">true</span>&#125;); <span class="comment">// (2)</span></span></span><br><span class="line"><span class="language-javascript">  elem.<span class="title function_">dispatchEvent</span>(event);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 在 document 上的处理程序将被激活，并显示消息。</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>对于自定义事件，应该使用<code>addEventListener</code>,而不是<code>on&lt;event&gt;</code> 必须设置<code>bubbles.true</code>,否则事件不会向上冒泡。</p>
<h3 id="4-5-3-UI事件"><a href="#4-5-3-UI事件" class="headerlink" title="4.5.3 UI事件"></a>4.5.3 UI事件</h3><p>对于一些UI事件，比如MouseEvent,KeyBoardEvent事件等，创建不能够使用new Event。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> event = <span class="keyword">new</span> <span class="title class_">MouseEvent</span>(<span class="string">&quot;click&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">bubbles</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">cancelable</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">clientX</span>: <span class="number">100</span>,</span><br><span class="line">  <span class="attr">clientY</span>: <span class="number">100</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(event.<span class="property">clientX</span>); <span class="comment">// 100</span></span><br></pre></td></tr></table></figure>

<h3 id="4-5-4-自定义事件"><a href="#4-5-4-自定义事件" class="headerlink" title="4.5.4 自定义事件"></a>4.5.4 自定义事件</h3><p>对于我们自己的全新事件类型，例如 “hello”，我们应该使用<code>new CustomEvent</code>。从技术上讲，<code>CustomEvent</code>和 <code>Event</code>一样。除了一点不同。 在第二个参数（对象）中，我们可以为我们想要与事件一起传递的任何自定义信息添加一个附加的属性<code>detail</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">&quot;elem&quot;</span>&gt;</span>Hello for John!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 事件附带给处理程序的其他详细信息</span></span></span><br><span class="line"><span class="language-javascript">  elem.<span class="title function_">addEventListener</span>(<span class="string">&quot;hello&quot;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(event.<span class="property">detail</span>.<span class="property">name</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  elem.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">CustomEvent</span>(<span class="string">&quot;hello&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">detail</span>: &#123; <span class="attr">name</span>: <span class="string">&quot;John&quot;</span> &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;));</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>detail</code>属性可以有任何数据。从技术上讲，我们可以不用，因为我们可以在创建后将任何属性分配给常规的<code>new Event</code> 对象中。但是<code>CustomEvent</code>提供了特殊的<code>detail</code>字段，以避免与其他事件属性的冲突。</p>
<p>此外，事件类描述了它是“什么类型的事件”，如果事件是自定义的，那么我们应该使用<code>CustomEvent</code>来明确它是什么。</p>
<h3 id="4-5-5-event-preventDefault"><a href="#4-5-5-event-preventDefault" class="headerlink" title="4.5.5 event.preventDefault()"></a>4.5.5 event.preventDefault()</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">pre</span> <span class="attr">id</span>=<span class="string">&quot;rabbit&quot;</span>&gt;</span></span><br><span class="line">  \   /</span><br><span class="line">   \_/</span><br><span class="line">   /. .\</span><br><span class="line">  =\_Y_/=</span><br><span class="line">   &#123;&gt;o&lt;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;hide()&quot;</span>&gt;</span>Hide()<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">hide</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> event = <span class="keyword">new</span> <span class="title class_">CustomEvent</span>(<span class="string">&quot;hide&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">cancelable</span>: <span class="literal">true</span> <span class="comment">// 没有这个标志，preventDefault 将不起作用</span></span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!rabbit.<span class="title function_">dispatchEvent</span>(event)) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(<span class="string">&#x27;The action was prevented by a handler&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      rabbit.<span class="property">hidden</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  rabbit.<span class="title function_">addEventListener</span>(<span class="string">&#x27;hide&#x27;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (<span class="title function_">confirm</span>(<span class="string">&quot;Call preventDefault?&quot;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">      event.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>通过调用<code>event.preventDefault()</code>，事件处理程序可以发出一个信号，指出默认行为应该被取消。</li>
<li>在这种情况下，<code>elem.dispatchEvent(event)</code>的调用会返回false。那么分派（dispatch）该事件的代码就会知道不应该再继续。</li>
<li>请注意：该事件必须具有<code>cancelable: true</code>标志，否则<code>event.preventDefault()</code>调用将会被忽略。</li>
</ul>
<h3 id="4-5-6-同步事件"><a href="#4-5-6-同步事件" class="headerlink" title="4.5.6 同步事件"></a>4.5.6 同步事件</h3><p>通常事件是在队列中处理的。也就是说：如果浏览器正在处理<code>onclick</code>，这时发生了一个新的事件，例如鼠标移动了，那么它的处理程序会被排入队列，相应的<code>mousemove</code>处理程序将在<code>onclick</code>事件处理完成后被调用。</p>
<p>值得注意的例外情况就是，一个事件是在另一个事件中发起的。例如使用<code>dispatchEvent</code>。这类事件将会被立即处理，即在新的事件处理程序被调用之后，恢复到当前的事件处理程序。</p>
<h2 id="4-6-鼠标事件"><a href="#4-6-鼠标事件" class="headerlink" title="4.6 鼠标事件"></a>4.6 鼠标事件</h2><p>鼠标事件不仅可能来自于“鼠标设备”，还可能来自于对此类操作进行了模拟以实现兼容性的其他设备，例如手机和平板电脑。</p>
<p>dbclick 双击鼠标 因为双击鼠标会造成副作用，比如说如果给文本绑定双击的话，还会选择文本 所以为了避免造成副作用，应该防止浏览器对<code>mousedown</code>进行操作。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Before</span>...</span><br><span class="line">&lt;b ondblclick=<span class="string">&quot;alert(&#x27;Click!&#x27;)&quot;</span> onmousedown=<span class="string">&quot;return false&quot;</span>&gt;</span><br><span class="line">  <span class="title class_">Double</span>-click me</span><br><span class="line">&lt;/b&gt;</span><br><span class="line">...<span class="title class_">After</span></span><br></pre></td></tr></table></figure>

<p>contextmenu 鼠标右键被按下时触发</p>
<p><strong>鼠标事件的顺序：</strong> 在单个动作触发多个事件时，事件的顺序是固定的。也就是说，会遵循 mousedown → mouseup → click 的顺序调用处理程序。 <code>button</code>属性允许检测鼠标按键</p>
<h3 id="4-6-1-鼠标按钮"><a href="#4-6-1-鼠标按钮" class="headerlink" title="4.6.1 鼠标按钮"></a>4.6.1 鼠标按钮</h3><p>与点击相关的事件始终具有<code>button</code>属性，该属性允许获取确切的鼠标按钮。</p>
<p>通常我们不在<code>click</code>和<code>contextmenu</code>事件中使用这一属性，因为前者只在单击鼠标左键时触发，后者只在单击鼠标右键时触发。 不过，在<code>mousedown</code>和<code>mouseup</code>事件中则可能需要用到<code>event.button</code>，因为这两个事件在任何按键上都会触发，所以我们可以使用<code>button</code>属性来区分是左键单击还是右键单击。</p>
<p>鼠标按键状态</p>
<p>event.button</p>
<p>左键 (主要按键)</p>
<p>0</p>
<p>中键 (辅助按键)</p>
<p>1</p>
<p>右键 (次要按键)</p>
<p>2</p>
<p>X1 键 (后退按键)</p>
<p>3</p>
<p>X2 键 (前进按键)</p>
<p>4</p>
<p>大多数鼠标设备只有左键和右键，对应的值就是 0 和 2。触屏设备中的点按操作也会触发类似的事件。</p>
<p>另外，还有一个<code>event.buttons</code>属性，其中以整数的形式存储着当前所有按下的鼠标按键，每个按键一个比特位。</p>
<p><strong>event.which已经被弃用，其是一种非常古老的获得按下的按键的方式</strong></p>
<h3 id="4-6-2-组合键"><a href="#4-6-2-组合键" class="headerlink" title="4.6.2 组合键"></a>4.6.2 组合键</h3><p>shift：shiftKey alt: altKey ctrl: ctrlKey metakey: 对于mac是cmd</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这个按钮只有在alt+shift+click才会生效</span></span><br><span class="line">&lt;button id=<span class="string">&quot;button&quot;</span>&gt;<span class="title class_">Alt</span>+<span class="title class_">Shift</span>+<span class="title class_">Click</span> on me!&lt;/button&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  button.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span> (event.<span class="property">altKey</span> &amp;&amp; event.<span class="property">shiftKey</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title function_">alert</span>(<span class="string">&#x27;Hooray!&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><strong>在mac上的不同操作：</strong> 在Windows和Linux上有Alt，Shift和Ctrl。在Mac上还有：Cmd，它对应于属性 metaKey。 在大多数情况下，当在 Windows&#x2F;Linux 上使用Ctrl时，在Mac是使用Cmd。 也就说：当 Windows 用户按下Ctrl+Enter或Ctrl+A时，Mac用户会按下Cmd+Enter或 Cmd+A，以此类推。 因此，如果我们想支持Ctrl+click，那么对于Mac应该使用 Cmd+click。对于Mac用户而言，这更舒适。 即使我们想强制Mac用户使用Ctrl+click —— 这非常困难。问题是：在MacOS上左键单击和Ctrl一起使用会被解释为右键单击，并且会生成contextmenu事件，而不是像 Windows&#x2F;Linux中的click事件。 因此，如果我们想让所有操作系统的用户都感到舒适，那么我们应该将ctrlKey与 metaKey一起进行检查。 对于 JS 代码，这意味着我们应该检查<code>if (event.ctrlKey event.metaKey)</code>。</p>
<h3 id="4-6-3-坐标"><a href="#4-6-3-坐标" class="headerlink" title="4.6.3 坐标"></a>4.6.3 坐标</h3><ol>
<li>相对于窗口的坐标：<code>clientX</code>和<code>clientY</code>。</li>
<li>相对于文档的坐标：<code>pageX</code>和<code>pageY</code>。</li>
</ol>
<p>相对于文档的坐标不会随着页面的滚动而改变。 相对于窗口的坐标是以当前窗口的左上角为参照物</p>
<h3 id="4-6-4-防止复制"><a href="#4-6-4-防止复制" class="headerlink" title="4.6.4 防止复制"></a>4.6.4 防止复制</h3><p>万恶之源来了 如果我们想禁用选择以保护我们页面的内容不被复制粘贴，那么我们可以使用另一个事件：<code>oncopy</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div oncopy=<span class="string">&quot;alert(&#x27;Copying forbidden!&#x27;);return false&quot;</span>&gt;</span><br><span class="line">  <span class="title class_">Dear</span> user,</span><br><span class="line">  <span class="title class_">The</span> copying is forbidden <span class="keyword">for</span> you.</span><br><span class="line">  <span class="title class_">If</span> you know <span class="variable constant_">JS</span> or <span class="variable constant_">HTML</span>, then you can get everything <span class="keyword">from</span> the page source though.</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h3 id="4-6-5-移动鼠标事件"><a href="#4-6-5-移动鼠标事件" class="headerlink" title="4.6.5 移动鼠标事件"></a>4.6.5 移动鼠标事件</h3><p><code>mouseover/mouseout</code>:当鼠标指针移到某个元素上时，<code>mouseover</code>事件就会发生，而当鼠标离开该元素时，<code>mouseout</code>事件就会发生。</p>
<p><code>mouseover</code>:</p>
<ul>
<li><code>event.target</code>——是鼠标移过的那个元素</li>
<li><code>event.relatedTarget</code>——是鼠标来自的那个元素（relatedtarget -&gt; target）</li>
</ul>
<p><code>mouseout</code>:</p>
<ul>
<li><code>event.target</code>——是鼠标离开的元素</li>
<li><code>event.relatedTarget</code>——是鼠标移动到的，当前指针位置下的元素（target-&gt; relatedTarget）</li>
</ul>
<p>mouseover 和 mouseout 完全相反</p>
<p><strong><code>relatedTarget</code>属性可以为null。</strong> 这是正常现象，仅仅是意味着鼠标不是来自另一个元素，而是来自窗口之外。或者它离开了窗口。 当我们在代码中使用<code>event.relatedTarget</code>时，我们应该牢记这种可能性。如果我们访问<code>event.relatedTarget.tagName</code>，那么就会出现错误。</p>
<p>在移动鼠标时，就会触发<code>mousemove</code>事件。 如果访问者移动鼠标非常快的话，某些元素可能会被跳过。</p>
<p>如果mouseover被触发了，则必须有mouseout</p>
<p>当从父元素转到子元素时，也会触发mouseover&#x2F;out事件。 浏览器假定鼠标一次只会位于一个元素上 —— 最深的那个。</p>
<p><code>mouseenter/mouseleave</code>: mouseenter&#x2F;mouseleave的最大区别就是，当鼠标指针进入一个元素时，会触发mouseenter,而就算它移动到child里也不会有影响，所以说其会忽略后代之间的移动，只有其移出元素时，才会触发mouseleave 并且其不会冒泡</p>
<h3 id="4-6-6-鼠标拖放事件"><a href="#4-6-6-鼠标拖放事件" class="headerlink" title="4.6.6 鼠标拖放事件"></a>4.6.6 鼠标拖放事件</h3><ol>
<li>在<code>mousedown</code>上 —— 根据需要准备要移动的元素（也许创建一个它的副本，向其中添加一个类或其他任何东西）。</li>
<li>然后在<code>mousemove</code>上，通过更改 position:absolute 情况下的 left&#x2F;top 来移动它。</li>
<li>在<code>mouseup</code>上 —— 执行与完成的拖放相关的所有行为。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">ball.<span class="property">onmousedown</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="comment">// (1) 准备移动：确保 absolute，并通过设置 z-index 以确保球在顶部</span></span><br><span class="line">  ball.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&#x27;absolute&#x27;</span>;</span><br><span class="line">  ball.<span class="property">style</span>.<span class="property">zIndex</span> = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 将其从当前父元素中直接移动到 body 中</span></span><br><span class="line">  <span class="comment">// 以使其定位是相对于 body 的</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">append</span>(ball);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 现在球的中心在 (pageX, pageY) 坐标上</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">moveAt</span>(<span class="params">pageX, pageY</span>) &#123;</span><br><span class="line">    ball.<span class="property">style</span>.<span class="property">left</span> = pageX - ball.<span class="property">offsetWidth</span> / <span class="number">2</span> + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">    ball.<span class="property">style</span>.<span class="property">top</span> = pageY - ball.<span class="property">offsetHeight</span> / <span class="number">2</span> + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 将我们绝对定位的球移到指针下方</span></span><br><span class="line">  <span class="title function_">moveAt</span>(event.<span class="property">pageX</span>, event.<span class="property">pageY</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">onMouseMove</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="title function_">moveAt</span>(event.<span class="property">pageX</span>, event.<span class="property">pageY</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// (2) 在 mousemove 事件上移动球</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, onMouseMove);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// (3) 放下球，并移除不需要的处理程序</span></span><br><span class="line">  ball.<span class="property">onmouseup</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, onMouseMove);</span><br><span class="line">    ball.<span class="property">onmouseup</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// 因为页面本身可能会有冲突，所以需要禁止这些行为</span></span><br><span class="line">  ball.<span class="property">ondragstart</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://zh.javascript.info/mouse-drag-and-drop">更多详情</a></p>
<p><a href="./js/dom/%E4%BA%8B%E4%BB%B6/%E6%BB%91%E5%8A%A8%E6%9D%A1.html">滑动条</a></p>
<h2 id="4-7-指针事件"><a href="#4-7-指针事件" class="headerlink" title="4.7 指针事件"></a>4.7 指针事件</h2><p>指针事件（Pointer Events）是一种用于处理来自各种输入设备（例如鼠标、触控笔和触摸屏等）的输入信息的现代化解决方案。</p>
<p>指针事件是用来替代鼠标事件的，而且和鼠标事件兼容，就是换成了pointer。 比如<code>mousedown</code>可以被替换成<code>pointerdown</code>。 我们可以把代码中的<code>mouse&lt;event&gt;</code>都替换成<code>pointer&lt;event&gt;</code>，程序仍然正常兼容鼠标设备。 替换之后，程序对触屏设备的支持会“魔法般”地提升。但是，我们可能需要在 CSS 中的某些地方添加<code>touch-action: none</code>。</p>
<h3 id="4-7-1-指针事件属性"><a href="#4-7-1-指针事件属性" class="headerlink" title="4.7.1 指针事件属性"></a>4.7.1 指针事件属性</h3><ul>
<li><code>pointerId</code>—— 触发当前事件的指针唯一标识符。 浏览器生成的。使我们能够处理多指针的情况，例如带有触控笔和多点触控功能的触摸屏（下文会有相关示例）。</li>
<li><code>pointerType</code> —— 指针的设备类型。必须为字符串，可以是：“mouse”、“pen” 或 “touch”。 我们可以使用这个属性来针对不同类型的指针输入做出不同响应。</li>
<li><code>isPrimary</code> —— 当指针为首要指针（多点触控时按下的第一根手指）时为 true。</li>
</ul>
<p>有些指针设备会测量接触面积和点按压力（例如一根手指压在触屏上），对于这种情况可以使用以下属性：</p>
<ul>
<li><code>width</code>—— 指针（例如手指）接触设备的区域的宽度。对于不支持的设备（如鼠标），这个值总是 1。</li>
<li><code>height</code>—— 指针（例如手指）接触设备的区域的长度。对于不支持的设备，这个值总是 1。</li>
<li><code>pressure</code>—— 触摸压力，是一个介于 0 到 1 之间的浮点数。对于不支持压力检测的设备，这个值总是 0.5（按下时）或 0。</li>
<li><code>tangentialPressure</code>—— 归一化后的切向压力（tangential pressure）。</li>
<li><code>tiltX, tiltY, twist</code>—— 针对触摸笔的几个属性，用于描述笔和屏幕表面的相对位置。</li>
</ul>
<h3 id="4-7-2-多点触控"><a href="#4-7-2-多点触控" class="headerlink" title="4.7.2 多点触控"></a>4.7.2 多点触控</h3><p><strong>多点触控（用户在手机或平板上同时点击若干个位置，或执行特殊手势）是鼠标事件完全不支持的功能之一。</strong></p>
<p>第一根手指触摸时： <code>pointerdown</code>事件触发，<code>isPrimary=true</code>，指派一个<code>pointerId</code>` 第二个和后续的更多个手指触摸（假设第一个手指仍在触摸）： <code>pointerdown</code>事件触发，<code>isPrimary=false</code>，并且每一个触摸都被指派了不同的 <code>pointerId</code>。</p>
<p><strong>对于多点触控事件来说，pointerId是由浏览器进行分配的，所以说如果有多根手指同时触摸屏幕，就会得到多个pointerdown事件和对应的坐标以及不同的pointerId。</strong></p>
<p>利用<code>pointerId</code>，我们可以追踪多根正在触摸屏幕的手指。当用户移动或抬起某根手指时，我们会得到和<code>pointerdown</code>事件具有相同<code>pointerId</code>的<code>pointermove</code>或<code>pointerup</code>事件。</p>
<h3 id="4-7-3-pointercancel"><a href="#4-7-3-pointercancel" class="headerlink" title="4.7.3 pointercancel"></a>4.7.3 pointercancel</h3><p><code>pointercancel</code>事件将会在一个正处于活跃状态的指针交互由于某些原因被中断时触发。也就是在这个事件之后，该指针就不会继续触发更多事件了。 导致指针中断的可能原因如下：</p>
<ul>
<li>指针设备硬件在物理层面上被禁用。</li>
<li>设备方向旋转（例如给平板转了个方向）。</li>
<li>浏览器打算自行处理这一交互，比如将其看作是一个专门的鼠标手势或缩放操作等。</li>
</ul>
<p><strong>阻止浏览器的默认行为来防止<code>pointercancel</code>触发。</strong></p>
<p>需要做两件事：</p>
<ol>
<li>阻止原生的拖放操作发生<ul>
<li>event.ondragstart &#x3D; () &#x3D;&gt; false</li>
</ul>
</li>
<li>对于触屏设备，还有其他和触摸相关的浏览器行为（除了拖放）。为了避免它们所引发的问题<ul>
<li>通过在 CSS 中设置 #event { touch-action: none } 来阻止它们。</li>
</ul>
</li>
</ol>
<h3 id="4-7-4-指针捕获"><a href="#4-7-4-指针捕获" class="headerlink" title="4.7.4 指针捕获"></a>4.7.4 指针捕获</h3><p><strong>指针捕获可以被用于简化拖放类的交互。</strong></p>
<p><code>elem.setPointerCapture(pointerId)</code>将所有具有给定<code>pointerId</code>的后续事件重新定位到<code>elem</code>。</p>
<p>绑定会在以下情况下被移除：</p>
<ul>
<li>当<code>pointerup</code>或<code>pointercancel</code>事件出现时，绑定会被自动地移除。</li>
<li>当<code>elem</code>被从文档中移除后，绑定会被自动地移除。</li>
<li>当<code>elem.releasePointerCapture(pointerId)</code>被调用，绑定会被移除。</li>
</ul>
<p>在<a href="./js/dom/%E4%BA%8B%E4%BB%B6/%E6%BB%91%E5%8A%A8%E6%9D%A1.html">滑动条</a>的处理中，我们可以在<code>pointerdown</code>事件的处理程序中调用<code>thumb.setPointerCapture(event.pointerId)</code>， 这样接下来在<code>pointerup/cancel</code>之前发生的所有指针事件都会被重定向到<code>thumb</code>上。 当<code>pointerup</code>发生时（拖动完成），绑定会被自动移除，我们不需要关心它。 因此，即使用户在整个文档上移动指针，事件处理程序也将仅在<code>thumb</code>上被调用。尽管如此，事件对象的坐标属性，例如<code>clientX/clientY</code>仍将是正确的 —— 捕获仅影响<code>target/currentTarget</code>。</p>
<p>所以说这个操作一下子就简化了拖拽的问题，以前鼠标事件的时候，它因为不是完全水平的拖动，所以移动的范围在整个document文档里，但是现在只指向了thumb上，就节省了很多空间，也减少了bug。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">thumb.<span class="property">onpointerdown</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="comment">// 把所有指针事件（pointerup 之前发生的）重定向到 thumb</span></span><br><span class="line">  thumb.<span class="title function_">setPointerCapture</span>(event.<span class="property">pointerId</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 开始跟踪指针的移动</span></span><br><span class="line">  thumb.<span class="property">onpointermove</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="comment">// 移动滑动条：在 thumb 上监听即可，因为所有指针事件都被重定向到了 thumb</span></span><br><span class="line">    <span class="keyword">let</span> newLeft = event.<span class="property">clientX</span> - slider.<span class="title function_">getBoundingClientRect</span>().<span class="property">left</span>;</span><br><span class="line">    thumb.<span class="property">style</span>.<span class="property">left</span> = newLeft + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 当结束(pointerup)时取消对指针移动的跟踪</span></span><br><span class="line">  thumb.<span class="property">onpointerup</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    thumb.<span class="property">onpointermove</span> = <span class="literal">null</span>;</span><br><span class="line">    thumb.<span class="property">onpointerup</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// ...这里还可以处理“拖动结束”相关的逻辑</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注意：无需调用 thumb.releasePointerCapture，</span></span><br><span class="line"><span class="comment">// 它会在 pointerup 时被自动调用```</span></span><br></pre></td></tr></table></figure>

<p>言而总之，指针捕获为我们带来了两个好处： 代码变得更加简洁，我们不再需要在整个 document 上添加&#x2F;移除处理程序。绑定会被自动释放。 如果文档中有其他指针事件处理程序，则在用户拖动滑动条时，它们不会因指针的移动被意外地触发。</p>
<p>还有两个与指针捕获相关的事件： <code>gotpointercapture</code>会在一个元素使用<code>setPointerCapture</code>来启用捕获后触发。 <code>lostpointercapture</code>会在捕获被释放后触发：其触发可能是由于<code>releasePointerCapture</code>的显式调用，或是<code>pointerup/pointercancel</code>事件触发后的自动调用。</p>
<h2 id="4-8-键盘事件"><a href="#4-8-键盘事件" class="headerlink" title="4.8 键盘事件"></a>4.8 键盘事件</h2><p>键盘事件不光是指键盘内容的输入，因为现代设备中还包括语音识别或者是鼠标的复制粘贴等。</p>
<p>当一个按键被按下时，会触发<code>keydown</code>事件，当按键被释放时，会触发<code>keyup</code>事件</p>
<h3 id="4-8-1-event-code-和-event-key"><a href="#4-8-1-event-code-和-event-key" class="headerlink" title="4.8.1 event.code 和 event.key"></a>4.8.1 event.code 和 event.key</h3><p>事件对象的<code>key</code>属性允许获取字符，而事件对象的<code>code</code>属性则允许获取“物理按键代码”。</p>
<p>例如，同一个按键 Z，可以与或不与 Shift 一起按下。我们会得到两个不同的字符：小写的 z 和大写的 Z。 (所以说shift+字母能获得大写字母0.0，新知识)</p>
<p><code>event.key</code>正是这个字符，并且它将是不同的。但是,<code>event.code</code>是相同的：</p>
<p>key</p>
<p>event.key</p>
<p>event.code</p>
<p>z</p>
<p>z</p>
<p>KeyZ</p>
<p>z</p>
<p>Z(大写)</p>
<p>KeyZ</p>
<p>所以说，event.key代表的是其本身所显示的值，但是event.code代表的是其的位置</p>
<p>如果用户使用不同的语言，那么切换到另一种语言将产生完全不同的字符，而不是 “Z”。它将成为 event.key 的值，而 event.code 则始终都是一样的：”KeyZ”。</p>
<ul>
<li>字符键的代码为 <code>&quot;Key&lt;letter&gt;&quot;</code>：”KeyA”，”KeyB” 等。</li>
<li>数字键的代码为：<code>&quot;Digit&lt;number&gt;&quot;</code>：”Digit0”，”Digit1” 等。</li>
<li>特殊按键的代码为按键的名字：<code>&quot;Enter&quot;</code>，”Backspace”，”Tab” 等。</li>
</ul>
<p><strong>在event.code中”KeyZ” 的首字母必须大写。</strong></p>
<p><code>event.code</code>准确地标明了哪个键被按下了。例如，大多数键盘有两个 Shift 键，一个在左边，一个在右边。<code>event.code</code>会准确地告诉我们按下了哪个键，而<code>event.key</code>对按键的“含义”负责：它是什么（一个 “Shift”）。</p>
<hr>
<p>key</p>
<p>event.key</p>
<p>event.code</p>
<p>F1</p>
<p>F1</p>
<p>F1</p>
<p>Backspace</p>
<p>Backspace</p>
<p>Backspace</p>
<p>Shift</p>
<p>Shift</p>
<p>ShiftRight&#x2F;ShiftLeft</p>
<hr>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;keydown&#x27;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (event.<span class="property">code</span> == <span class="string">&#x27;KeyZ&#x27;</span> &amp;&amp; (event.<span class="property">ctrlKey</span>  event.<span class="property">metaKey</span>)) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;Undo!&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>给按键绑定一个ctrl+z的行为，就是event.code更好，因为event.code只代表位置，而event.key会随语言等产生变化。并且要兼容mac，所以需要metaKey</p>
<p>但是event.code也有问题，就是美式布局和德式布局的不同。（但是感觉现在用德式布局的很少哎）</p>
<p>所以说，对于会切换语言的问题，event.code更合适 而对于不同布局的问题，event.key更合适</p>
<p>如果按下一个键足够长的时间，它就会开始“自动重复”：keydown 会被一次又一次地触发，然后当按键被释放时，我们最终会得到 keyup。因此，有很多 keydown 却只有一个 keyup 是很正常的。 对于由自动重复触发的事件，event 对象的<code>event.repeat</code>属性被设置为 true。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkPhoneKey</span>(<span class="params">key</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (key &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; key &lt;= <span class="string">&#x27;9&#x27;</span>)  [<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;ArrowLeft&#x27;</span>,<span class="string">&#x27;ArrowRight&#x27;</span>,<span class="string">&#x27;Delete&#x27;</span>,<span class="string">&#x27;Backspace&#x27;</span>].<span class="title function_">includes</span>(key);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">onkeydown</span>=<span class="string">&quot;return checkPhoneKey(event.key)&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入手机号&quot;</span> <span class="attr">type</span>=<span class="string">&quot;tel&quot;</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>对手机号进行检查，如果无效输入则不会返回。</p>
<p><strong>即使我们对按键进行了过滤，但仍然可以使用鼠标右键单击 + 粘贴来输入任何内容。移动端设备提供了其他输入内容的方式。因此，这个过滤器并不是 100% 可靠。</strong></p>
<p>另一种方式是跟踪<code>oninput</code>事件 —— 在任何修改后都会触发此事件。这样我们就可以检查新的<code>input.value</code>，并在其无效时修改它&#x2F;高亮显示<code>&lt;input&gt;</code>。或者我们可以同时使用这两个事件处理程序。</p>
<h2 id="4-9-滚动事件"><a href="#4-9-滚动事件" class="headerlink" title="4.9 滚动事件"></a>4.9 滚动事件</h2><p>滚动事件通过<code>scroll</code>来进行，允许对页面或元素滚动做出反应。</p>
<p><code>scroll</code>事件在<code>window</code>和可滚动元素上都可以运行。</p>
<p>启动滚动的方式有很多，使用 CSS 的<code>overflow</code>属性更加可靠。</p>
<h1 id="五、表单属性和方法"><a href="#五、表单属性和方法" class="headerlink" title="五、表单属性和方法"></a>五、表单属性和方法</h1><p>学习关于表单（form）和<code>&lt;input&gt;</code>控件的属性和事件</p>
<p>表单可以从<code>document.forms</code>中找到 表单在document中是一个特殊的集合，其既是命名的，也是有序的。 所以可以通过名字或者在文档中的编号来获取表单</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">forms</span>.<span class="property">my</span>; <span class="comment">// name=&quot;my&quot; 的表单</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">forms</span>[<span class="number">0</span>]; <span class="comment">// 文档中的第一个表单</span></span><br></pre></td></tr></table></figure>

<p>当我们有了一个表单时，其中的任何元素都可以通过命名的集合<code>form.elements</code>来获取到。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;form name=<span class="string">&quot;my&quot;</span>&gt;</span><br><span class="line">  &lt;input name=&quot;one&quot; value=&quot;1&quot;&gt;</span><br><span class="line">  &lt;input name=&quot;two&quot; value=&quot;2&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  // 获取表单</span><br><span class="line">  let form = document.forms.my; // &lt;form name=&quot;my&quot;&gt; 元素</span><br><span class="line"></span><br><span class="line">  // 获取表单中的元素</span><br><span class="line">  let elem = form.elements.one; // &lt;input name=&quot;one&quot;&gt; 元素</span><br><span class="line"></span><br><span class="line">  alert(elem.value); // 1</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>可能会有多个名字相同的元素，这种情况经常在处理单选按钮中出现。</p>
<p>在这种情况下,<code>form.elements[name]</code>将会是一个集合。例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;form&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> form = <span class="variable language_">document</span>.<span class="property">forms</span>[<span class="number">0</span>];</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> ageElems = form.<span class="property">elements</span>.<span class="property">age</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">alert</span>(ageElems[<span class="number">0</span>]); <span class="comment">// [object HTMLInputElement]</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>可以通过<code>form[index/name]</code>来访问元素。 换句话说，我们可以将<code>form.elements.login</code>写成<code>form.login</code>。 这也有效，但是会有一个小问题：如果我们访问一个元素，然后修改它的 name，之后它仍然可以被通过旧的 name 访问到（当然也能通过新的 name 访问）。</p>
<p><strong>form可以反向引用</strong> 比如说我可以通过<code>form.element</code>来找到这个元素，那么也可以通过<code>element.form</code>来反向引用这个表单</p>
<p>我们可以通过<code>input.value</code>（字符串）或<code>input.checked</code>（布尔值）来访问复选框（checkbox）和单选按钮（radio button）中的 value。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">input.<span class="property">value</span> = <span class="string">&quot;New value&quot;</span>;</span><br><span class="line">textarea.<span class="property">value</span> = <span class="string">&quot;New text&quot;</span>;</span><br><span class="line"></span><br><span class="line">input.<span class="property">checked</span> = <span class="literal">true</span>; <span class="comment">// 对于复选框（checkbox）或单选按钮（radio button）</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;select&gt;元素就是下滑框</code> 一个<code>&lt;select&gt;</code>元素有 3 个重要的属性：</p>
<ul>
<li><code>select.options</code> —— <code>&lt;option&gt;</code>的子元素的集合，</li>
<li><code>select.value</code> —— 当前所选择的<code>&lt;option&gt;</code>的 value，</li>
<li><code>select.selectedIndex</code> —— 当前所选择的<code>&lt;option&gt;</code>的编号。</li>
</ul>
<p>它们提供了三种为<code>&lt;select&gt;</code>设置 value 的不同方式： 找到对应的<code>&lt;option&gt;</code>元素（例如在<code>select.options</code>中），并将其<code>option.selected</code>设置为 true。 如果我们知道新的值：将<code>select.value</code>设置为对应的新的值。 如果我们知道新的选项的索引：将<code>select.selectedIndex</code>设置为对应 <code>&lt;option&gt;</code>的编号。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=<span class="string">&quot;select&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;apple&quot;</span>&gt;</span>Apple<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;pear&quot;</span>&gt;</span>Pear<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;banana&quot;</span>&gt;</span>Banana<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 下面这三行做的都是同一件事</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  select.<span class="property">options</span>[<span class="number">2</span>].<span class="property">selected</span> = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  select.<span class="property">selectedIndex</span> = <span class="number">2</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  select.<span class="property">value</span> = <span class="string">&#x27;banana&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 请注意：选项编号是从零开始的，所以编号 2 表示的是第三项</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>如果<code>&lt;select&gt;</code>具有<code>multiple</code>特性（attribute），则允许多选。尽管这个特性（attribute）很少被用到。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=<span class="string">&quot;select&quot;</span> multiple&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;blues&quot;</span> <span class="attr">selected</span>&gt;</span>Blues<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;rock&quot;</span> <span class="attr">selected</span>&gt;</span>Rock<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;classic&quot;</span>&gt;</span>Classic<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="comment">// 从 multi-select 中获取所有选定的 `value`</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">let</span> selected = <span class="title class_">Array</span>.<span class="title function_">from</span>(select.<span class="property">options</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    .<span class="title function_">filter</span>(<span class="function"><span class="params">option</span> =&gt;</span> option.<span class="property">selected</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    .<span class="title function_">map</span>(<span class="function"><span class="params">option</span> =&gt;</span> option.<span class="property">value</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">alert</span>(selected); <span class="comment">// blues,rock</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>如何创建一个新的option <code>option = new Option(text, value, defaultSelected, selected);</code> 其中text代表文本，value代表值，defaultSelected如果为true，则selected特性会被创建，selected为true，则其会被选中</p>
<p><code>defaultSelected</code>和<code>selected</code>的区别是，<code>defaultSelected</code>设置的是 HTML-特性（attribute），我们可以使用<code>option.getAttribute(&#39;selected&#39;)</code> 来获得。而 selected 设置的是选项是否被选中。</p>
<p>在实际使用中，通常应该将同时将这两个值设置为 true 或 false。（或者，直接省略它们；两者都默认为 false。）</p>
<h2 id="5-1-聚焦（focus-x2F-blur）"><a href="#5-1-聚焦（focus-x2F-blur）" class="headerlink" title="5.1 聚焦（focus&#x2F;blur）"></a>5.1 聚焦（focus&#x2F;blur）</h2><p>当用户点击某个元素或使用键盘上的 Tab 键选中时，该元素将会获得聚焦（focus）。还有一个 HTML 特性（attribute）autofocus 可以让焦点在网页加载时默认落在一个元素上，此外还有其它途径可以获得焦点。</p>
<p>聚焦到一个元素通常意味着：“准备在此处接受数据”，所以，这正是我们可以运行代码以初始化所需功能的时刻。</p>
<p>失去焦点的时刻（“blur”）可能更为重要。它可能发生在用户点击页面的其它地方，或者按下 Tab 键跳转到下一个表单字段，亦或是其它途径的时候。</p>
<p>失去焦点通常意味着：“数据已经输入完成”，所以我们可以运行代码来检查它，甚至可以将其保存到服务器上，或进行其他操作。</p>
<p><strong>当元素聚焦时，会触发<code>focus</code>事件，当元素失去焦点时，会触发<code>blur</code>事件。</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.invalid</span> &#123; <span class="attribute">border-color</span>: red; &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#error</span> &#123; <span class="attribute">color</span>: red &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">Your email please: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;error&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">input.<span class="property">onblur</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (!input.<span class="property">value</span>.<span class="title function_">includes</span>(<span class="string">&#x27;@&#x27;</span>)) &#123; <span class="comment">// not email</span></span></span><br><span class="line"><span class="language-javascript">    input.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;invalid&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    error.<span class="property">innerHTML</span> = <span class="string">&#x27;Please enter a correct email.&#x27;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">input.<span class="property">onfocus</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;invalid&#x27;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 移除 &quot;error&quot; 指示，因为用户想要重新输入一些内容</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;invalid&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    error.<span class="property">innerHTML</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面这段就是一个关于focus和blur的示例，当元素不聚焦时，如果输入框中的值不包含@，则会添加一个使框变红的类，并且添加一个错误信息。 而当元素再进入聚焦时，则会将这些信息清除掉。以此来重新输入信息</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.error</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: red;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">Your email please: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:220px&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;make email invalid and try to focus here&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  input.<span class="property">onblur</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">value</span>.<span class="title function_">includes</span>(<span class="string">&#x27;@&#x27;</span>)) &#123; <span class="comment">// not email</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 显示 error</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;error&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// ...将焦点放回来</span></span></span><br><span class="line"><span class="language-javascript">      input.<span class="title function_">focus</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;error&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面这段代码更有意思，其通过给非聚焦元素添加了一个设置焦点，从而使如果没有@这个符号，焦点就不会转移 所以说：可以通过<code>elem.focus()</code>来设置元素的焦点。或者通过<code>elem.blur()</code>来移除元素的焦点</p>
<p><strong>这段代码在除了火狐（bug）之外的浏览器上都可以正常工作。</strong></p>
<p><strong>JavaScript 导致的焦点丢失</strong></p>
<ul>
<li>一个 alert 会将焦点移至自身，因此会导致元素失去焦点（触发 blur 事件），而当 alert 对话框被取消时，焦点又回重新回到原元素上（触发 focus 事件）。</li>
<li>如果一个元素被从 DOM 中移除，那么也会导致焦点丢失。如果稍后它被重新插入到 DOM，焦点也不会回到它身上。</li>
</ul>
<p>这些特性有时候会导致 focus&#x2F;blur 处理程序发生异常 —— 在不需要它们时触发。</p>
<h3 id="5-1-1-tabindex-强行聚焦"><a href="#5-1-1-tabindex-强行聚焦" class="headerlink" title="5.1.1 tabindex(强行聚焦)"></a>5.1.1 tabindex(强行聚焦)</h3><p>默认情况下，很多元素不支持聚焦。</p>
<p>列表（list）在不同的浏览器表现不同，但有一件事总是正确的：focus&#x2F;blur 保证支持那些用户可以交互的元素：<code>&lt;button&gt;</code>，<code>&lt;input&gt;</code>，<code>&lt;select&gt;</code>，<code>&lt;a&gt;</code> 等。</p>
<p>另一方面，为了格式化某些东西而存在的元素像<code>&lt;div&gt;</code>，<code>&lt;span&gt;</code>和<code>&lt;table&gt;</code>—— 默认是不能被聚焦的。<code>elem.focus()</code>方法不适用于它们，并且 focus&#x2F;blur 事件也绝不会被触发。</p>
<p>使用 HTML-特性（attribute)<code>tabindex</code>可以改变这种情况。</p>
<p>任何具有<code>tabindex</code>特性的元素，都会变成可聚焦的。该特性的value是当使用 Tab（或类似的东西）在元素之间进行切换时，元素的顺序号。</p>
<p>也就是说：如果我们有两个元素，第一个具有<code>tabindex=&quot;1&quot;</code>，第二个具有 <code>tabindex=&quot;2&quot;</code>，然后当焦点在第一个元素的时候，按下 Tab 键，会使焦点移动到第二个元素身上。</p>
<p>切换顺序为：从 1 开始的具有 tabindex 的元素排在前面（按 tabindex 顺序），然后是不具有 tabindex 的元素（例如常规的<code>&lt;input&gt;</code>）。</p>
<p>不具有 tabindex 的元素按文档源顺序（默认顺序）切换。</p>
<p><strong>特殊情况</strong></p>
<ul>
<li><p><code>tabindex=&quot;0&quot;</code>会使该元素被与那些不具有 tabindex 的元素放在一起。也就是说，当我们切换元素时，具有 <code>tabindex=&quot;0&quot;</code>的元素将排在那些具有 tabindex ≥ 1 的元素的后面。 通常，它用于使元素具有焦点，但是保留默认的切换顺序。使元素成为与<code>&lt;input&gt;</code>一样的表单的一部分。</p>
</li>
<li><p><code>tabindex=&quot;-1&quot;</code>只允许以编程的方式聚焦于元素。Tab 键会忽略这样的元素，但是 <code>elem.focus()</code>有效。</p>
</li>
</ul>
<p>我们可以使用<code>elem.tabIndex</code>通过 JavaScript 来添加<code>tabindex</code>。效果是一样的。</p>
<h3 id="5-1-2-委托"><a href="#5-1-2-委托" class="headerlink" title="5.1.2 委托"></a>5.1.2 委托</h3><p><code>focus</code>和<code>blur</code>事件不会向上冒泡。</p>
<p>因为当用户聚焦于<code>&lt;input&gt;</code>时，focus 事件只会在该<code>&lt;input&gt;</code>上触发。它不会向上冒泡。所以<code>form.onfocus</code>永远不会触发。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;form&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Name&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;surname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Surname&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"> <span class="selector-class">.focused</span> &#123; <span class="attribute">outline</span>: <span class="number">1px</span> solid red; &#125; </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 将处理程序置于捕获阶段（最后一个参数为 true）</span></span></span><br><span class="line"><span class="language-javascript">  form.<span class="title function_">addEventListener</span>(<span class="string">&quot;focus&quot;</span>, <span class="function">() =&gt;</span> form.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;focused&#x27;</span>), <span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript">  form.<span class="title function_">addEventListener</span>(<span class="string">&quot;blur&quot;</span>, <span class="function">() =&gt;</span> form.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;focused&#x27;</span>), <span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以通过在捕获阶段添加focus事件来解决问题</p>
<p>或者说可以通过<code>focusin</code>和<code>focusout</code>事件来进行，其和<code>focus/blur</code>完全一样，但是他们会冒泡。</p>
<p>值得注意的是，必须使用<code>elem.addEventListener</code>来分配它们，而不是 <code>on&lt;event&gt;</code>。</p>
<h2 id="5-2-事件：change、input、cut、copy、paste"><a href="#5-2-事件：change、input、cut、copy、paste" class="headerlink" title="5.2 事件：change、input、cut、copy、paste"></a>5.2 事件：change、input、cut、copy、paste</h2><h3 id="5-2-1-change"><a href="#5-2-1-change" class="headerlink" title="5.2.1 change"></a>5.2.1 change</h3><p>当元素更改完成时，将触发<code>change</code>事件。 对于文本输入框，当其失去焦点时，就会触发<code>change</code>事件。</p>
<p>例如，当我们在下面的文本字段中键入内容时 —— 不会触发 change 事件。但是，当我们将焦点移到其他位置时，例如，点击按钮 —— 就会触发 change 事件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> onchange=<span class="string">&quot;alert(this.value)&quot;</span>&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Button&quot;</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>对于其它元素：<code>select</code>，<code>input type=checkbox/radio</code>，会在选项更改后立即触发change事件。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;select onchange=<span class="string">&quot;alert(this.value)&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>Select something<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>Option 1<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span>Option 2<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>&gt;</span>Option 3<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-2-input"><a href="#5-2-2-input" class="headerlink" title="5.2.2 input"></a>5.2.2 input</h3><p>每当用户对输入值进行修改后，就会触发<code>input</code>事件。</p>
<p>与键盘事件不同，只要值改变了，<code>input</code>事件就会触发，即使那些不涉及键盘行为（action）的值的更改也是如此：使用鼠标粘贴，或者使用语音识别来输入文本。</p>
<p>如果我们想要处理对<code>&lt;input&gt;</code>的每次更改，那么<code>oninput</code>事件是最佳选择。</p>
<p>另一方面，input 事件不会在那些不涉及值更改的键盘输入或其他行为上触发，例如在输入时按方向键 ⇦ ⇨。</p>
<p>当输入值更改后，就会触发<code>input</code>事件。</p>
<p>所以，我们无法使用<code>event.preventDefault()</code> —— 已经太迟了，不会起任何作用了。</p>
<h3 id="5-2-3-cut、copy、paste"><a href="#5-2-3-cut、copy、paste" class="headerlink" title="5.2.3 cut、copy、paste"></a>5.2.3 cut、copy、paste</h3><p>这些事件发生于剪切&#x2F;拷贝&#x2F;粘贴一个值的时候。 它们属于 <a target="_blank" rel="noopener" href="https://www.w3.org/TR/clipboard-apis/#clipboard-event-interfaces">ClipboardEvent</a> 类，并提供了对剪切&#x2F;拷贝&#x2F;粘贴的数据的访问方法。 我们也可以使用<code>event.preventDefault()</code>来中止行为，然后什么都不会被复制&#x2F;粘贴。</p>
<p>下面的代码阻止了剪切&#x2F;拷贝&#x2F;粘贴的事件，并显示出了我们所尝试剪切&#x2F;拷贝&#x2F;粘贴的内容：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;input&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  input.<span class="property">onpaste</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(<span class="string">&quot;paste: &quot;</span> + event.<span class="property">clipboardData</span>.<span class="title function_">getData</span>(<span class="string">&#x27;text/plain&#x27;</span>));</span></span><br><span class="line"><span class="language-javascript">    event.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  input.<span class="property">oncut</span> = input.<span class="property">oncopy</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">alert</span>(event.<span class="property">type</span> + <span class="string">&#x27;-&#x27;</span> + <span class="variable language_">document</span>.<span class="title function_">getSelection</span>());</span></span><br><span class="line"><span class="language-javascript">    event.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在剪切&#x2F;复制事件处理程序中调用<code>event.clipboardData.getData(...)</code>只会得到一个空字符串。从技术上讲，这是因为此时数据还未存入剪切板。如果我们使用<code>event.preventDefault()</code>，则它根本不会被复制。</p>
<p>所以上面的例子中使用<code>document.getSelection()</code>来得到被选中的文本。</p>
<p>我们不仅可以复制&#x2F;粘贴文本，也可以复制&#x2F;粘贴其他各种内容。例如，我们可以在操作系统的文件管理器中复制一个文件并进行粘贴。</p>
<p>这是因为<code>clipboardData</code>实现了<code>DataTransfer</code>接口，通常用于拖放和复制&#x2F;粘贴。这超出了本文所讨论的范围，但你可以在<a target="_blank" rel="noopener" href="https://html.spec.whatwg.org/multipage/dnd.html#the-datatransfer-interface">DataTransfer规范</a> 中进行详细了解。</p>
<p>另外，还有一个可以访问剪切板的异步API：<code>navigator.clipboard</code>，详见 <a target="_blank" rel="noopener" href="https://www.w3.org/TR/clipboard-apis/">Clipboard API 和事件规范</a></p>
<h3 id="5-2-4-安全限制"><a href="#5-2-4-安全限制" class="headerlink" title="5.2.4 安全限制"></a>5.2.4 安全限制</h3><p>剪贴板是“全局”操作系统级别的东西。用户可能会在各种应用程序之间切换，复制&#x2F;粘贴不同的内容，而浏览器页面不应该能访问这些内容。</p>
<p>因此，大多数浏览器仅允许在某些用户操作范围内（例如复制&#x2F;粘贴等）对剪切板进行无缝的读&#x2F;写访问。</p>
<p>除火狐（Firefox）浏览器外，所有浏览器都禁止使用<code>dispatchEvent</code>生成“自定义”剪贴板事件，即使我们设法调度此类事件。规范也明确声明了，合成（syntetic）事件不得提供对剪切板的访问权限。</p>
<p>此外，如果有人想将<code>event.clipboardData</code>保存在事件处理程序中，然后稍后再访问它 —— 这也不会生效。</p>
<p>重申，<code>event.clipboardData</code>仅在用户启动的事件处理程序的上下文中生效。</p>
<p>另外, <code>navigator.clipboard</code>是一个较新的 API，适用于任何上下文。如果需要，它会请求用户的许可。火狐（Firefox）浏览器尚未支持。</p>
<h2 id="5-3-表单：事件和方法提交"><a href="#5-3-表单：事件和方法提交" class="headerlink" title="5.3 表单：事件和方法提交"></a>5.3 表单：事件和方法提交</h2><p>提交表单时，会触发<code>submit</code>事件，它通常用于在将表单发送到服务器之前对表单进行校验，或者中止提交，并使用 JavaScript 来处理表单。</p>
<p><code>form.submit()</code>方法允许从 JavaScript 启动表单发送。我们可以使用此方法动态地创建表单，并将其发送到服务器。</p>
<h3 id="5-3-1-submit"><a href="#5-3-1-submit" class="headerlink" title="5.3.1 submit"></a>5.3.1 submit</h3><p>提交表单主要有两种方式：</p>
<ol>
<li>第一种 —— 点击<code>&lt;input type=&quot;submit&quot;&gt;</code>或<code>&lt;input type=&quot;image&quot;&gt;</code>。</li>
<li>第二种 —— 在 input 字段中按下 Enter 键。</li>
</ol>
<p>这两个行为都会触发表单的 submit 事件。处理程序可以检查数据，如果有错误，就显示出来，并调用<code>event.preventDefault()</code>，这样表单就不会被发送到服务器了。</p>
<p><strong>在输入框中使用 Enter 发送表单时，会在<code>&lt;input type=&quot;submit&quot;&gt;</code>上触发一次 <code>click</code>事件。</strong> 但实际上，其没有进行点击</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onsubmit</span>=<span class="string">&quot;return false&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">size</span>=<span class="string">&quot;30&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Focus here and press enter&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(&#x27;click&#x27;)&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-3-2-手动提交"><a href="#5-3-2-手动提交" class="headerlink" title="5.3.2 手动提交"></a>5.3.2 手动提交</h3><p>如果要手动将表单提交到服务器，我们可以调用<code>form.submit()</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> form = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;form&#x27;</span>);</span><br><span class="line">form.<span class="property">action</span> = <span class="string">&#x27;https://google.com/search&#x27;</span>;</span><br><span class="line">form.<span class="property">method</span> = <span class="string">&#x27;GET&#x27;</span>;</span><br><span class="line"></span><br><span class="line">form.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;input name=&quot;q&quot; value=&quot;test&quot;&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 该表单必须在文档中才能提交</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">append</span>(form);</span><br><span class="line"></span><br><span class="line">form.<span class="title function_">submit</span>();</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/05/26/simclrv2/" rel="prev" title="SimCLRv2">
                  <i class="fa fa-chevron-left"></i> SimCLRv2
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/06/22/js%E8%A1%A5%E5%85%85%E7%9F%A5%E8%AF%86/" rel="next" title="js补充知识">
                  js补充知识 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wh&CC</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
